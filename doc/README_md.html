<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>README - mcollective version 2.12.1</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script src="./js/jquery.js"></script>
<script src="./js/darkfish.js"></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>

  <ul class="link-list" role="directory">
    <li><a href="#label-The+Marionette+Collective">The Marionette Collective</a>
    <li><a href="#label-Developing">Developing</a>
    <li><a href="#label-Spec+Tests">Spec Tests</a>
    <li><a href="#label-Acceptance+Tests">Acceptance Tests</a>
    <li><a href="#label-Development+Environment+-28MacOS-29">Development Environment (MacOS)</a>
    <li><a href="#label-Contributing">Contributing</a>
  </ul>
</div>


  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="./CONTRIBUTING_md.html">CONTRIBUTING</a>
  
    <li><a href="./COPYING.html">COPYING</a>
  
    <li><a href="./Gemfile.html">Gemfile</a>
  
    <li><a href="./MAINTAINERS.html">MAINTAINERS</a>
  
    <li><a href="./README_md.html">README</a>
  
    <li><a href="./Rakefile.html">Rakefile</a>
  
    <li><a href="./acceptance/Gemfile.html">Gemfile</a>
  
    <li><a href="./acceptance/README_md.html">README</a>
  
    <li><a href="./acceptance/Rakefile.html">Rakefile</a>
  
    <li><a href="./acceptance/config/nodes/centos-5-x86_64_yaml.html">centos-5-x86_64.yaml</a>
  
    <li><a href="./acceptance/config/nodes/centos-6-x86_64_yaml.html">centos-6-x86_64.yaml</a>
  
    <li><a href="./acceptance/config/nodes/debian-6-x86_64_yaml.html">debian-6-x86_64.yaml</a>
  
    <li><a href="./acceptance/config/nodes/debian-7-x86_64_yaml.html">debian-7-x86_64.yaml</a>
  
    <li><a href="./acceptance/config/nodes/debian-8-x86_64_yaml.html">debian-8-x86_64.yaml</a>
  
    <li><a href="./acceptance/config/nodes/fedora-20-x86_64_yaml.html">fedora-20-x86_64.yaml</a>
  
    <li><a href="./acceptance/config/nodes/fedora-21-x86_64_yaml.html">fedora-21-x86_64.yaml</a>
  
    <li><a href="./acceptance/config/nodes/redhat-5-x86_64_yaml.html">redhat-5-x86_64.yaml</a>
  
    <li><a href="./acceptance/config/nodes/redhat-6-x86_64_yaml.html">redhat-6-x86_64.yaml</a>
  
    <li><a href="./acceptance/config/nodes/redhat-7-x86_64_yaml.html">redhat-7-x86_64.yaml</a>
  
    <li><a href="./acceptance/config/nodes/ubuntu-1204-x86_64_yaml.html">ubuntu-1204-x86_64.yaml</a>
  
    <li><a href="./acceptance/config/nodes/ubuntu-1404-x86_64_yaml.html">ubuntu-1404-x86_64.yaml</a>
  
    <li><a href="./acceptance/config/nodes/ubuntu-1410-x86_64_yaml.html">ubuntu-1410-x86_64.yaml</a>
  
    <li><a href="./acceptance/config/nodes/win2003r2x64-rubyx64_yaml.html">win2003r2x64-rubyx64.yaml</a>
  
    <li><a href="./acceptance/config/nodes/win2003r2x64-rubyx86_yaml.html">win2003r2x64-rubyx86.yaml</a>
  
    <li><a href="./acceptance/config/nodes/win2003r2x86-rubyx86_yaml.html">win2003r2x86-rubyx86.yaml</a>
  
    <li><a href="./acceptance/config/nodes/win2003x64-rubyx64_yaml.html">win2003x64-rubyx64.yaml</a>
  
    <li><a href="./acceptance/config/nodes/win2003x64-rubyx86_yaml.html">win2003x64-rubyx86.yaml</a>
  
    <li><a href="./acceptance/config/nodes/win2003x86-rubyx86_yaml.html">win2003x86-rubyx86.yaml</a>
  
    <li><a href="./acceptance/config/nodes/win2008-rubyx64_yaml.html">win2008-rubyx64.yaml</a>
  
    <li><a href="./acceptance/config/nodes/win2008-rubyx86_yaml.html">win2008-rubyx86.yaml</a>
  
    <li><a href="./acceptance/config/nodes/win2008r2-rubyx64_yaml.html">win2008r2-rubyx64.yaml</a>
  
    <li><a href="./acceptance/config/nodes/win2008r2-rubyx86_yaml.html">win2008r2-rubyx86.yaml</a>
  
    <li><a href="./acceptance/config/nodes/win2012-rubyx64_yaml.html">win2012-rubyx64.yaml</a>
  
    <li><a href="./acceptance/config/nodes/win2012-rubyx86_yaml.html">win2012-rubyx86.yaml</a>
  
    <li><a href="./acceptance/config/nodes/win2012r2-rubyx64_yaml.html">win2012r2-rubyx64.yaml</a>
  
    <li><a href="./acceptance/config/nodes/win2012r2-rubyx86_yaml.html">win2012r2-rubyx86.yaml</a>
  
    <li><a href="./acceptance/files/activemq_xml.html">activemq.xml</a>
  
    <li><a href="./acceptance/files/ca_crt_pem.html">ca_crt.pem</a>
  
    <li><a href="./acceptance/files/client_cfg.html">client.cfg</a>
  
    <li><a href="./acceptance/files/client_crt.html">client.crt</a>
  
    <li><a href="./acceptance/files/client_key.html">client.key</a>
  
    <li><a href="./acceptance/files/server_crt.html">server.crt</a>
  
    <li><a href="./acceptance/files/server_key.html">server.key</a>
  
    <li><a href="./acceptance/files/windows-client_cfg.html">windows-client.cfg</a>
  
    <li><a href="./acceptance/ssl/ca/ca_crl_pem.html">ca_crl.pem</a>
  
    <li><a href="./acceptance/ssl/ca/ca_crt_pem.html">ca_crt.pem</a>
  
    <li><a href="./acceptance/ssl/ca/ca_key_pem.html">ca_key.pem</a>
  
    <li><a href="./acceptance/ssl/ca/ca_pub_pem.html">ca_pub.pem</a>
  
    <li><a href="./acceptance/ssl/ca/inventory_txt.html">inventory</a>
  
    <li><a href="./acceptance/ssl/ca/private/ca_pass.html">ca.pass</a>
  
    <li><a href="./acceptance/ssl/ca/serial.html">serial</a>
  
    <li><a href="./acceptance/ssl/ca/signed/activemq_pem.html">activemq.pem</a>
  
    <li><a href="./acceptance/ssl/ca/signed/mcollective-client_pem.html">mcollective-client.pem</a>
  
    <li><a href="./acceptance/ssl/ca/signed/mcollective-server_pem.html">mcollective-server.pem</a>
  
    <li><a href="./acceptance/ssl/ca/signed/socks_local_pem.html">socks.local.pem</a>
  
    <li><a href="./acceptance/ssl/certs/activemq_pem.html">activemq.pem</a>
  
    <li><a href="./acceptance/ssl/certs/ca_pem.html">ca.pem</a>
  
    <li><a href="./acceptance/ssl/certs/mcollective-client_pem.html">mcollective-client.pem</a>
  
    <li><a href="./acceptance/ssl/certs/mcollective-server_pem.html">mcollective-server.pem</a>
  
    <li><a href="./acceptance/ssl/certs/socks_local_pem.html">socks.local.pem</a>
  
    <li><a href="./acceptance/ssl/crl_pem.html">crl.pem</a>
  
    <li><a href="./acceptance/ssl/private_keys/activemq_pem.html">activemq.pem</a>
  
    <li><a href="./acceptance/ssl/private_keys/mcollective-client_pem.html">mcollective-client.pem</a>
  
    <li><a href="./acceptance/ssl/private_keys/mcollective-server_pem.html">mcollective-server.pem</a>
  
    <li><a href="./acceptance/ssl/private_keys/socks_local_pem.html">socks.local.pem</a>
  
    <li><a href="./acceptance/ssl/public_keys/activemq_pem.html">activemq.pem</a>
  
    <li><a href="./acceptance/ssl/public_keys/mcollective-client_pem.html">mcollective-client.pem</a>
  
    <li><a href="./acceptance/ssl/public_keys/mcollective-server_pem.html">mcollective-server.pem</a>
  
    <li><a href="./acceptance/ssl/public_keys/socks_local_pem.html">socks.local.pem</a>
  
    <li><a href="./etc/client_cfg_dist.html">client.cfg.dist</a>
  
    <li><a href="./etc/facts_yaml_dist.html">facts.yaml.dist</a>
  
    <li><a href="./etc/server_cfg_dist.html">server.cfg.dist</a>
  
    <li><a href="./etc/ssl/PLACEHOLDER.html">PLACEHOLDER</a>
  
    <li><a href="./etc/ssl/clients/PLACEHOLDER.html">PLACEHOLDER</a>
  
    <li><a href="./lib/mcollective/agent/rpcutil_ddl.html">rpcutil.ddl</a>
  
    <li><a href="./lib/mcollective/aggregate/average_ddl.html">average.ddl</a>
  
    <li><a href="./lib/mcollective/aggregate/sum_ddl.html">sum.ddl</a>
  
    <li><a href="./lib/mcollective/aggregate/summary_ddl.html">summary.ddl</a>
  
    <li><a href="./lib/mcollective/connector/activemq_ddl.html">activemq.ddl</a>
  
    <li><a href="./lib/mcollective/connector/rabbitmq_ddl.html">rabbitmq.ddl</a>
  
    <li><a href="./lib/mcollective/data/agent_data_ddl.html">agent_data.ddl</a>
  
    <li><a href="./lib/mcollective/data/collective_data_ddl.html">collective_data.ddl</a>
  
    <li><a href="./lib/mcollective/data/fact_data_ddl.html">fact_data.ddl</a>
  
    <li><a href="./lib/mcollective/data/fstat_data_ddl.html">fstat_data.ddl</a>
  
    <li><a href="./lib/mcollective/discovery/flatfile_ddl.html">flatfile.ddl</a>
  
    <li><a href="./lib/mcollective/discovery/mc_ddl.html">mc.ddl</a>
  
    <li><a href="./lib/mcollective/discovery/stdin_ddl.html">stdin.ddl</a>
  
    <li><a href="./lib/mcollective/validator/array_validator_ddl.html">array_validator.ddl</a>
  
    <li><a href="./lib/mcollective/validator/ipv4address_validator_ddl.html">ipv4address_validator.ddl</a>
  
    <li><a href="./lib/mcollective/validator/ipv6address_validator_ddl.html">ipv6address_validator.ddl</a>
  
    <li><a href="./lib/mcollective/validator/length_validator_ddl.html">length_validator.ddl</a>
  
    <li><a href="./lib/mcollective/validator/regex_validator_ddl.html">regex_validator.ddl</a>
  
    <li><a href="./lib/mcollective/validator/shellsafe_validator_ddl.html">shellsafe_validator.ddl</a>
  
    <li><a href="./lib/mcollective/validator/typecheck_validator_ddl.html">typecheck_validator.ddl</a>
  
    <li><a href="./mcollective_init.html">mcollective.init</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page README.md">

<h1 id="label-The+Marionette+Collective">The Marionette Collective<span><a href="#label-The+Marionette+Collective">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p>The Marionette Collective aka. mcollective is a framework to build server
orchestration or parallel job execution systems.</p>

<p>For documentation please see <a
href="https://docs.puppet.com/mcollective">docs.puppet.com/mcollective</a></p>

<h2 id="label-Developing">Developing<span><a href="#label-Developing">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>The documentation above details how <a
href="MCollective.html">MCollective</a> works and many of its extension
points.</p>

<h3 id="label-Spec+Tests">Spec Tests<span><a href="#label-Spec+Tests">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>To run spec tests <code> bundle install bundle exec rake test </code></p>

<h3 id="label-Acceptance+Tests">Acceptance Tests<span><a href="#label-Acceptance+Tests">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>To run acceptance tests, see <a href="acceptance/README.md">this</a>.</p>

<h3 id="label-Development+Environment+-28MacOS-29">Development Environment (MacOS)<span><a href="#label-Development+Environment+-28MacOS-29">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>Setup ActiveMQ using acceptance config: <code> brew install activemq cp
acceptance/files/activemq.* /usr/local/opt/activemq/libexec/conf activemq
start </code></p>

<p>ActiveMQ can later by stopped with <code>activemq stop</code>. ActiveMQ
logs are located at
<code>/usr/local/opt/activemq/libexec/data/activemq.log</code>.</p>

<p>Setup <a href="MCollective.html">MCollective</a> with acceptance config:
<code> mkdir -p ~/.puppetlabs/etc/mcollective/ssl-clients cp
acceptance/files/client.* ~/.puppetlabs/etc/mcollective cp
acceptance/files/server.* ~/.puppetlabs/etc/mcollective cp
acceptance/files/ca_crt.pem ~/.puppetlabs/etc/mcollective cp
acceptance/files/client.crt
~/.puppetlabs/etc/mcollective/ssl-clients/client.pem ln -s
~/.puppetlabs/etc/mcollective/client.cfg ~/.mcollective </code></p>

<p>Modify <code>client.cfg</code> to work on the local machine: * Change the
<code>ssl_server_public</code>, <code>ssl_client_private</code>,
<code>ssl_client_public</code> paths to point to
<code>~/.puppetlabs/etc/mcollective/{server.crt,client.key,client.pem}</code>.
* Change the <code>activemq.pool.1.ssl.{ca,cert,key}</code> paths to
<code>~/.puppetlabs/etc/mcollective/{ca_crt.pem,client.crt,client.key}</code>.
Note that <code>~</code> needs to be expanded to the full path. Also, that
<code>client.pem</code> doesn’t point to an actual file is intentional (I
don’t fully understand why).</p>

<p>Create <code>server.cfg</code>, updating <code>&lt;user&gt;</code>: “`
main_collective = mcollective collectives = mcollective logger_type =
console loglevel = info daemonize = 0</p>

<p>securityprovider = ssl plugin.ssl_server_private =
/Users/&lt;user&gt;/.puppetlabs/etc/mcollective/server.key
plugin.ssl_server_public =
/Users/&lt;user&gt;/.puppetlabs/etc/mcollective/server.crt
plugin.ssl_client_cert_dir =
/Users/&lt;user&gt;/.puppetlabs/etc/mcollective/ssl-clients</p>

<p>connector = activemq plugin.activemq.pool.size = 1
plugin.activemq.pool.1.host = activemq plugin.activemq.pool.1.port = 61613
plugin.activemq.pool.1.user = mcollective plugin.activemq.pool.1.password =
marionette plugin.activemq.pool.1.ssl = true plugin.activemq.pool.1.ssl.ca
= /Users/&lt;user&gt;/.puppetlabs/etc/mcollective/ca_crt.pem
plugin.activemq.pool.1.ssl.cert =
/Users/&lt;user&gt;/.puppetlabs/etc/mcollective/server.crt
plugin.activemq.pool.1.ssl.key =
/Users/&lt;user&gt;/.puppetlabs/etc/mcollective/server.key “`</p>

<p>The configuration above uses <code>activemq</code> as the name of the
ActiveMQ broker. <a href="MCollective.html">MCollective</a> will enforce
that the SSL certificate presented by the server matches the name it’s
trying to connect to. To use the configuration above, traffic to
<code>activemq</code> must be redirected to the local host. On most
machines, that can be accomplished with <code> sudo echo &quot;127.0.0.1  
activemq&quot; &gt;&gt; /etc/hosts </code></p>

<p>From the root of this repository, test the setup by running a server <code>
RUBYLIB=lib bundle exec bin/mcollectived --config
~/.puppetlabs/etc/mcollective/server.cfg </code> and client <code>
RUBYLIB=lib bundle exec bin/mco ping </code></p>

<p>Note that it may be useful to change the <code>loglevel</code> in
<code>client.cfg</code> to debug issues with <code>mco ping</code>.</p>

<p>To enable specific plugins, you may need to set <code>libdir</code> in
<code>server.cfg</code> and add plugin-specific configuration.</p>

<h2 id="label-Contributing">Contributing<span><a href="#label-Contributing">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Please refer to <a href="CONTRIBUTING.md">this</a> document.</p>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

