<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>README - mcollective version 2.12.5</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
  var index_rel_prefix = "../";
</script>

<script src="../js/navigation.js" defer></script>
<script src="../js/search.js" defer></script>
<script src="../js/search_index.js" defer></script>
<script src="../js/searcher.js" defer></script>
<script src="../js/darkfish.js" defer></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>

  <ul class="link-list" role="directory">
    <li><a href="#label-WARNING">WARNING</a>
    <li><a href="#label-Files+directory">Files directory</a>
    <li><a href="#label-SSL+setup">SSL setup</a>
    <li><a href="#label-Running+with+Rake">Running with Rake</a>
    <li><a href="#label-Environment+variables">Environment variables</a>
  </ul>
</div>


  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="../CONTRIBUTING_md.html">CONTRIBUTING</a>
  
    <li><a href="../COPYING.html">COPYING</a>
  
    <li><a href="../Gemfile.html">Gemfile</a>
  
    <li><a href="../Gemfile_lock.html">Gemfile.lock</a>
  
    <li><a href="../MAINTAINERS.html">MAINTAINERS</a>
  
    <li><a href="../README_md.html">README</a>
  
    <li><a href="../Rakefile.html">Rakefile</a>
  
    <li><a href="../acceptance/Gemfile.html">Gemfile</a>
  
    <li><a href="../acceptance/Gemfile_lock.html">Gemfile.lock</a>
  
    <li><a href="../acceptance/README_md.html">README</a>
  
    <li><a href="../acceptance/Rakefile.html">Rakefile</a>
  
    <li><a href="../acceptance/config/nodes/centos-5-x86_64_yaml.html">centos-5-x86_64.yaml</a>
  
    <li><a href="../acceptance/config/nodes/centos-6-x86_64_yaml.html">centos-6-x86_64.yaml</a>
  
    <li><a href="../acceptance/config/nodes/debian-6-x86_64_yaml.html">debian-6-x86_64.yaml</a>
  
    <li><a href="../acceptance/config/nodes/debian-7-x86_64_yaml.html">debian-7-x86_64.yaml</a>
  
    <li><a href="../acceptance/config/nodes/debian-8-x86_64_yaml.html">debian-8-x86_64.yaml</a>
  
    <li><a href="../acceptance/config/nodes/fedora-20-x86_64_yaml.html">fedora-20-x86_64.yaml</a>
  
    <li><a href="../acceptance/config/nodes/fedora-21-x86_64_yaml.html">fedora-21-x86_64.yaml</a>
  
    <li><a href="../acceptance/config/nodes/redhat-5-x86_64_yaml.html">redhat-5-x86_64.yaml</a>
  
    <li><a href="../acceptance/config/nodes/redhat-6-x86_64_yaml.html">redhat-6-x86_64.yaml</a>
  
    <li><a href="../acceptance/config/nodes/redhat-7-x86_64_yaml.html">redhat-7-x86_64.yaml</a>
  
    <li><a href="../acceptance/config/nodes/ubuntu-1204-x86_64_yaml.html">ubuntu-1204-x86_64.yaml</a>
  
    <li><a href="../acceptance/config/nodes/ubuntu-1404-x86_64_yaml.html">ubuntu-1404-x86_64.yaml</a>
  
    <li><a href="../acceptance/config/nodes/ubuntu-1410-x86_64_yaml.html">ubuntu-1410-x86_64.yaml</a>
  
    <li><a href="../acceptance/config/nodes/win2003r2x64-rubyx64_yaml.html">win2003r2x64-rubyx64.yaml</a>
  
    <li><a href="../acceptance/config/nodes/win2003r2x64-rubyx86_yaml.html">win2003r2x64-rubyx86.yaml</a>
  
    <li><a href="../acceptance/config/nodes/win2003r2x86-rubyx86_yaml.html">win2003r2x86-rubyx86.yaml</a>
  
    <li><a href="../acceptance/config/nodes/win2003x64-rubyx64_yaml.html">win2003x64-rubyx64.yaml</a>
  
    <li><a href="../acceptance/config/nodes/win2003x64-rubyx86_yaml.html">win2003x64-rubyx86.yaml</a>
  
    <li><a href="../acceptance/config/nodes/win2003x86-rubyx86_yaml.html">win2003x86-rubyx86.yaml</a>
  
    <li><a href="../acceptance/config/nodes/win2008-rubyx64_yaml.html">win2008-rubyx64.yaml</a>
  
    <li><a href="../acceptance/config/nodes/win2008-rubyx86_yaml.html">win2008-rubyx86.yaml</a>
  
    <li><a href="../acceptance/config/nodes/win2008r2-rubyx64_yaml.html">win2008r2-rubyx64.yaml</a>
  
    <li><a href="../acceptance/config/nodes/win2008r2-rubyx86_yaml.html">win2008r2-rubyx86.yaml</a>
  
    <li><a href="../acceptance/config/nodes/win2012-rubyx64_yaml.html">win2012-rubyx64.yaml</a>
  
    <li><a href="../acceptance/config/nodes/win2012-rubyx86_yaml.html">win2012-rubyx86.yaml</a>
  
    <li><a href="../acceptance/config/nodes/win2012r2-rubyx64_yaml.html">win2012r2-rubyx64.yaml</a>
  
    <li><a href="../acceptance/config/nodes/win2012r2-rubyx86_yaml.html">win2012r2-rubyx86.yaml</a>
  
    <li><a href="../acceptance/files/activemq_xml.html">activemq.xml</a>
  
    <li><a href="../acceptance/files/ca_crt_pem.html">ca_crt.pem</a>
  
    <li><a href="../acceptance/files/client_cfg.html">client.cfg</a>
  
    <li><a href="../acceptance/files/client_crt.html">client.crt</a>
  
    <li><a href="../acceptance/files/client_key.html">client.key</a>
  
    <li><a href="../acceptance/files/server_crt.html">server.crt</a>
  
    <li><a href="../acceptance/files/server_key.html">server.key</a>
  
    <li><a href="../acceptance/files/windows-client_cfg.html">windows-client.cfg</a>
  
    <li><a href="../acceptance/ssl/ca/ca_crl_pem.html">ca_crl.pem</a>
  
    <li><a href="../acceptance/ssl/ca/ca_crt_pem.html">ca_crt.pem</a>
  
    <li><a href="../acceptance/ssl/ca/ca_key_pem.html">ca_key.pem</a>
  
    <li><a href="../acceptance/ssl/ca/ca_pub_pem.html">ca_pub.pem</a>
  
    <li><a href="../acceptance/ssl/ca/inventory_txt.html">inventory</a>
  
    <li><a href="../acceptance/ssl/ca/private/ca_pass.html">ca.pass</a>
  
    <li><a href="../acceptance/ssl/ca/serial.html">serial</a>
  
    <li><a href="../acceptance/ssl/ca/signed/activemq_pem.html">activemq.pem</a>
  
    <li><a href="../acceptance/ssl/ca/signed/mcollective-client_pem.html">mcollective-client.pem</a>
  
    <li><a href="../acceptance/ssl/ca/signed/mcollective-server_pem.html">mcollective-server.pem</a>
  
    <li><a href="../acceptance/ssl/ca/signed/socks_local_pem.html">socks.local.pem</a>
  
    <li><a href="../acceptance/ssl/certs/activemq_pem.html">activemq.pem</a>
  
    <li><a href="../acceptance/ssl/certs/ca_pem.html">ca.pem</a>
  
    <li><a href="../acceptance/ssl/certs/mcollective-client_pem.html">mcollective-client.pem</a>
  
    <li><a href="../acceptance/ssl/certs/mcollective-server_pem.html">mcollective-server.pem</a>
  
    <li><a href="../acceptance/ssl/certs/socks_local_pem.html">socks.local.pem</a>
  
    <li><a href="../acceptance/ssl/crl_pem.html">crl.pem</a>
  
    <li><a href="../acceptance/ssl/private_keys/activemq_pem.html">activemq.pem</a>
  
    <li><a href="../acceptance/ssl/private_keys/mcollective-client_pem.html">mcollective-client.pem</a>
  
    <li><a href="../acceptance/ssl/private_keys/mcollective-server_pem.html">mcollective-server.pem</a>
  
    <li><a href="../acceptance/ssl/private_keys/socks_local_pem.html">socks.local.pem</a>
  
    <li><a href="../acceptance/ssl/public_keys/activemq_pem.html">activemq.pem</a>
  
    <li><a href="../acceptance/ssl/public_keys/mcollective-client_pem.html">mcollective-client.pem</a>
  
    <li><a href="../acceptance/ssl/public_keys/mcollective-server_pem.html">mcollective-server.pem</a>
  
    <li><a href="../acceptance/ssl/public_keys/socks_local_pem.html">socks.local.pem</a>
  
    <li><a href="../etc/client_cfg_dist.html">client.cfg.dist</a>
  
    <li><a href="../etc/facts_yaml_dist.html">facts.yaml.dist</a>
  
    <li><a href="../etc/server_cfg_dist.html">server.cfg.dist</a>
  
    <li><a href="../etc/ssl/PLACEHOLDER.html">PLACEHOLDER</a>
  
    <li><a href="../etc/ssl/clients/PLACEHOLDER.html">PLACEHOLDER</a>
  
    <li><a href="../lib/mcollective/agent/rpcutil_ddl.html">rpcutil.ddl</a>
  
    <li><a href="../lib/mcollective/aggregate/average_ddl.html">average.ddl</a>
  
    <li><a href="../lib/mcollective/aggregate/sum_ddl.html">sum.ddl</a>
  
    <li><a href="../lib/mcollective/aggregate/summary_ddl.html">summary.ddl</a>
  
    <li><a href="../lib/mcollective/connector/activemq_ddl.html">activemq.ddl</a>
  
    <li><a href="../lib/mcollective/connector/rabbitmq_ddl.html">rabbitmq.ddl</a>
  
    <li><a href="../lib/mcollective/data/agent_data_ddl.html">agent_data.ddl</a>
  
    <li><a href="../lib/mcollective/data/collective_data_ddl.html">collective_data.ddl</a>
  
    <li><a href="../lib/mcollective/data/fact_data_ddl.html">fact_data.ddl</a>
  
    <li><a href="../lib/mcollective/data/fstat_data_ddl.html">fstat_data.ddl</a>
  
    <li><a href="../lib/mcollective/discovery/flatfile_ddl.html">flatfile.ddl</a>
  
    <li><a href="../lib/mcollective/discovery/mc_ddl.html">mc.ddl</a>
  
    <li><a href="../lib/mcollective/discovery/stdin_ddl.html">stdin.ddl</a>
  
    <li><a href="../lib/mcollective/validator/array_validator_ddl.html">array_validator.ddl</a>
  
    <li><a href="../lib/mcollective/validator/ipv4address_validator_ddl.html">ipv4address_validator.ddl</a>
  
    <li><a href="../lib/mcollective/validator/ipv6address_validator_ddl.html">ipv6address_validator.ddl</a>
  
    <li><a href="../lib/mcollective/validator/length_validator_ddl.html">length_validator.ddl</a>
  
    <li><a href="../lib/mcollective/validator/regex_validator_ddl.html">regex_validator.ddl</a>
  
    <li><a href="../lib/mcollective/validator/shellsafe_validator_ddl.html">shellsafe_validator.ddl</a>
  
    <li><a href="../lib/mcollective/validator/typecheck_validator_ddl.html">typecheck_validator.ddl</a>
  
    <li><a href="../mcollective_init.html">mcollective.init</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page acceptance/README.md">

<p>beaker tests for validation of <a href="../MCollective.html"><code>MCollective</code></a> in puppet-agent</p>

<h1 id="label-WARNING">WARNING<span><a href="#label-WARNING">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p><img src="http://upload.wikimedia.org/wikipedia/commons/thumb/b/bc/Chinese_black_dragon.svg/235px-Chinese_black_dragon.svg.png"></p>

<p><strong>WARNING:</strong> Under NO circumstances should you use <strong>any</strong> of the certificate files located in the /acceptance directory or any of its subdirectories in a production system. The private keys are publicly available and <strong>will</strong> result in an insecure environment</p>

<h1 id="label-Files+directory">Files directory<span><a href="#label-Files+directory">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p>/files contains pre-generated certificates and configuration files that are used by the acceptance test pre-suites in order to quickly facilitate a running environment on the system under test. The certificates in the /files directory are for testing purposes only and are publicly available.</p>

<p>These files were generated using the command outlined below, in the <em>SSL setup</em> section.</p>

<h1 id="label-SSL+setup">SSL setup<span><a href="#label-SSL+setup">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p>/ssl is a puppet master&#39;s ssl directory. Selected files from this have been copied into the files/ directory, either directly as .pem files, or combined into java truststores.</p>

<p>Commands used to set it up:</p>

<pre>puppet master --ssldir=`pwd`/ssl
puppet cert --ssldir=`pwd`/ssl generate activemq
puppet cert --ssldir=`pwd`/ssl generate mcollective-client
puppet cert --ssldir=`pwd`/ssl generate mcollective-server

keytool -storepasswd -storepass notsecret -import -alias &#39;puppet ca&#39; -file ssl/ca/ca_crt.pem -keystore files/activemq.truststore
cat ssl/private_keys/activemq.pem ssl/certs/activemq.pem &gt; activemq.combined.pem
openssl pkcs12 -password pass:notsecret -export -in activemq.combined.pem -out activemq.p12 -name activemq.example.com
keytool -importkeystore -destkeystore files/activemq.keystore -deststorepass notsecret -srckeystore activemq.p12 -srcstoretype PKCS12 -srcstorepass notsecret -alias activemq.example.com
rm activemq.combined.pem activemq.p12

cp ssl/ca/ca_crt.pem files/ca_crt.pem
cp ssl/certs/mcollective-server.pem files/server.crt
cp ssl/private_keys/mcollective-server.pem files/server.key
cp ssl/certs/mcollective-client.pem files/client.crt
cp ssl/private_keys/mcollective-client.pem files/client.key</pre>

<h1 id="label-Running+with+Rake">Running with Rake<span><a href="#label-Running+with+Rake">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p>The rake task <code>ci:test:aio</code> will provision, install, and execute the tests for you. It requires the environment variable for the sha of the puppet-agent version that should be installed during testing.</p>

<p>The minimal invocation of this task would be: <code> bundle exec rake ci:test:aio  SHA=1.8.2 </code></p>

<p>Typically, this task would be invoked against a development build with a specific host target in mind. Given that we would like to test the MCO functionality in the latest nightly build of puppet-agent on an Ubuntu 16.04 x86_64 instance, the command would be: <code> bundle exec rake ci:test:aio  SHA=nightly TEST_TARGET=ubuntu1604-64mco_master.a </code></p>

<h2 id="label-Environment+variables">Environment variables<span><a href="#label-Environment+variables">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>The following environment variables are used in conjunction with the <code>ci:test:aio</code> rake task:</p>

<p>SHA <em>required</em>  : Build identifier of puppet-agent version to be installed, release tag  or full SHA, (e.g. <code>nightly</code>, <code>1.8.2</code>,  <code>aa3068e6859a695167a4b7ac06584b4d4ace525f</code>).</p>

<p>SUITE_VERSION  : If the SHA used is a development build, then this variable must be  specified, (e.g. 1.8.2.62.gaa3068e).</p>

<p>TEST_TARGET  : Beaker-hostgenerator string used to dynamically create a Beaker hosts  file. The <code>mco_master</code> role must be part of this string. If left  unspecified, this will default to <code>windows2012r2-64mco_master.a</code>.</p>

<p>MASTER_TEST_TARGET  : Beaker-hostgenerator string used to dynamically create a Beaker hosts  file. If unspecified, this will default to <code>redhat7-64ma</code>.</p>

<p>BEAKER_HOSTS  : Path to an existing Beaker hosts file to be used.</p>

<p>ACTIVEMQ_SOURCE  : A url from which to download pre-built ActiveMQ binaries. Together with  ACTIVEMQ_VERSION, specifies where to get binaries. The default uses an  internal <a href="../Puppet.html"><code>Puppet</code></a> mirror, externally you should use <a href="http://apache.osuosl.org">apache.osuosl.org</a>.  Note that osuosl only hosts the latest releases. Setting this will attempt  to fetch a package from $ACTIVEMQ_SOURCE/activemq/$ACTIVEMQ_VERSION/apache-activemq-$ACTIVEMQ_VERSION-bin.tar.gz  (or .zip on Windows).</p>

<p>ACTIVEMQ_VERSION  : The version of ActiveMQ requested.</p>

<p>JDK_SOURCE  : A url from which to download pre-built JDK binaries for Windows (other  platforms use the package manager for the OS). Together with  JDK_VERSION_FULL, specifies where to get binaries. The default uses an  internal <a href="../Puppet.html"><code>Puppet</code></a> mirror, externally you should use <a href="https://download.oracle.com/otn-pub/java/jdk">download.oracle.com/otn-pub/java/jdk</a></p>

<p>JDK_VERSION_FULL  : The full version of JDK requested. From Oracle, this should include the  build number (e.g. <code>8u111-b14</code>). See the <a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">Oracle JDK downoad page</a>  for details.</p>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.2.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

