<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: MCollective::RPC::Client</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">MCollective::RPC::Client</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../files/lib/mcollective/rpc/client_rb.html">
                lib/mcollective/rpc/client.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
The main component of the Simple <a href="../RPC.html">RPC</a> client
system, this wraps around <a href="../Client.html">MCollective::Client</a>
and just brings in a lot of convention and standard approached.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000117">agent_filter</a>&nbsp;&nbsp;
      <a href="#M000127">batch_size=</a>&nbsp;&nbsp;
      <a href="#M000128">batch_sleep_time=</a>&nbsp;&nbsp;
      <a href="#M000115">class_filter</a>&nbsp;&nbsp;
      <a href="#M000124">collective=</a>&nbsp;&nbsp;
      <a href="#M000119">compound_filter</a>&nbsp;&nbsp;
      <a href="#M000114">custom_request</a>&nbsp;&nbsp;
      <a href="#M000110">disconnect</a>&nbsp;&nbsp;
      <a href="#M000122">discover</a>&nbsp;&nbsp;
      <a href="#M000116">fact_filter</a>&nbsp;&nbsp;
      <a href="#M000111">help</a>&nbsp;&nbsp;
      <a href="#M000118">identity_filter</a>&nbsp;&nbsp;
      <a href="#M000126">limit_method=</a>&nbsp;&nbsp;
      <a href="#M000125">limit_targets=</a>&nbsp;&nbsp;
      <a href="#M000113">method_missing</a>&nbsp;&nbsp;
      <a href="#M000109">new</a>&nbsp;&nbsp;
      <a href="#M000112">new_request</a>&nbsp;&nbsp;
      <a href="#M000123">options</a>&nbsp;&nbsp;
      <a href="#M000120">reset</a>&nbsp;&nbsp;
      <a href="#M000121">reset_filter</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">agent</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">batch_mode</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">batch_size</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">batch_sleep_time</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">client</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">config</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ddl</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">discovery_timeout</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">filter</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">limit_method</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">limit_targets</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">output_format</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">progress</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">reply_to</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">stats</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">timeout</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ttl</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">verbose</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000109" class="method-detail">
        <a name="M000109"></a>

        <div class="method-heading">
          <a href="#M000109" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(agent, flags = {}) {|parser, opts| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates a stub for a remote agent, you can pass in an <a
href="Client.html#M000123">options</a> array in the flags which will then
be used else it will just create a default <a
href="Client.html#M000123">options</a> array with filtering enabled based
on the standard command line use.
</p>
<pre>
  rpc = RPC::Client.new(&quot;rpctest&quot;, :configfile =&gt; &quot;client.cfg&quot;, :options =&gt; options)
</pre>
<p>
You typically would not call this directly you&#8216;d use <a
href="../RPC.html#M000070">MCollective::RPC#rpcclient</a> instead which is
a wrapper around this that can be used as a Mixin
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000109-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000109-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 19</span>
 19:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">agent</span>, <span class="ruby-identifier">flags</span> = {})
 20:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">flags</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:options</span>)
 21:           <span class="ruby-identifier">initial_options</span> = <span class="ruby-identifier">flags</span>[<span class="ruby-identifier">:options</span>]
 22: 
 23:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@@initial_options</span>
 24:           <span class="ruby-identifier">initial_options</span> = <span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">load</span>(<span class="ruby-ivar">@@initial_options</span>)
 25: 
 26:         <span class="ruby-keyword kw">else</span>
 27:           <span class="ruby-identifier">oparser</span> = <span class="ruby-constant">MCollective</span><span class="ruby-operator">::</span><span class="ruby-constant">Optionparser</span>.<span class="ruby-identifier">new</span>({<span class="ruby-identifier">:verbose</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">:progress_bar</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">:mcollective_limit_targets</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">:batch_size</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">:batch_sleep_time</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>}, <span class="ruby-value str">&quot;filter&quot;</span>)
 28: 
 29:           <span class="ruby-identifier">initial_options</span> = <span class="ruby-identifier">oparser</span>.<span class="ruby-identifier">parse</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">parser</span>, <span class="ruby-identifier">opts</span><span class="ruby-operator">|</span>
 30:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
 31:               <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">parser</span>, <span class="ruby-identifier">opts</span>)
 32:             <span class="ruby-keyword kw">end</span>
 33: 
 34:             <span class="ruby-constant">Helpers</span>.<span class="ruby-identifier">add_simplerpc_options</span>(<span class="ruby-identifier">parser</span>, <span class="ruby-identifier">opts</span>)
 35:           <span class="ruby-keyword kw">end</span>
 36: 
 37:           <span class="ruby-ivar">@@initial_options</span> = <span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-identifier">initial_options</span>)
 38:         <span class="ruby-keyword kw">end</span>
 39: 
 40:         <span class="ruby-ivar">@stats</span> = <span class="ruby-constant">Stats</span>.<span class="ruby-identifier">new</span>
 41:         <span class="ruby-ivar">@agent</span> = <span class="ruby-identifier">agent</span>
 42:         <span class="ruby-ivar">@discovery_timeout</span> = <span class="ruby-identifier">initial_options</span>[<span class="ruby-identifier">:disctimeout</span>]
 43:         <span class="ruby-ivar">@timeout</span> = <span class="ruby-identifier">initial_options</span>[<span class="ruby-identifier">:timeout</span>]
 44:         <span class="ruby-ivar">@verbose</span> = <span class="ruby-identifier">initial_options</span>[<span class="ruby-identifier">:verbose</span>]
 45:         <span class="ruby-ivar">@filter</span> = <span class="ruby-identifier">initial_options</span>[<span class="ruby-identifier">:filter</span>]
 46:         <span class="ruby-ivar">@config</span> = <span class="ruby-identifier">initial_options</span>[<span class="ruby-identifier">:config</span>]
 47:         <span class="ruby-ivar">@discovered_agents</span> = <span class="ruby-keyword kw">nil</span>
 48:         <span class="ruby-ivar">@progress</span> = <span class="ruby-identifier">initial_options</span>[<span class="ruby-identifier">:progress_bar</span>]
 49:         <span class="ruby-ivar">@limit_targets</span> = <span class="ruby-identifier">initial_options</span>[<span class="ruby-identifier">:mcollective_limit_targets</span>]
 50:         <span class="ruby-ivar">@limit_method</span> = <span class="ruby-constant">Config</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">rpclimitmethod</span>
 51:         <span class="ruby-ivar">@output_format</span> = <span class="ruby-identifier">initial_options</span>[<span class="ruby-identifier">:output_format</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">:console</span>
 52:         <span class="ruby-ivar">@force_direct_request</span> = <span class="ruby-keyword kw">false</span>
 53:         <span class="ruby-ivar">@reply_to</span> = <span class="ruby-identifier">initial_options</span>[<span class="ruby-identifier">:reply_to</span>]
 54: 
 55:         <span class="ruby-ivar">@batch_size</span> = <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">initial_options</span>[<span class="ruby-identifier">:batch_size</span>] <span class="ruby-operator">||</span> <span class="ruby-value">0</span>)
 56:         <span class="ruby-ivar">@batch_sleep_time</span> = <span class="ruby-constant">Float</span>(<span class="ruby-identifier">initial_options</span>[<span class="ruby-identifier">:batch_sleep_time</span>] <span class="ruby-operator">||</span> <span class="ruby-value">1</span>)
 57:         <span class="ruby-ivar">@batch_mode</span> = <span class="ruby-ivar">@batch_size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
 58: 
 59:         <span class="ruby-identifier">agent_filter</span> <span class="ruby-identifier">agent</span>
 60: 
 61:         <span class="ruby-ivar">@client</span> = <span class="ruby-constant">MCollective</span><span class="ruby-operator">::</span><span class="ruby-constant">Client</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@config</span>)
 62:         <span class="ruby-ivar">@client</span>.<span class="ruby-identifier">options</span> = <span class="ruby-identifier">initial_options</span>
 63: 
 64:         <span class="ruby-ivar">@collective</span> = <span class="ruby-ivar">@client</span>.<span class="ruby-identifier">collective</span>
 65:         <span class="ruby-ivar">@ttl</span> = <span class="ruby-identifier">initial_options</span>[<span class="ruby-identifier">:ttl</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">Config</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">ttl</span>
 66: 
 67:         <span class="ruby-comment cmt"># if we can find a DDL for the service override</span>
 68:         <span class="ruby-comment cmt"># the timeout of the client so we always magically</span>
 69:         <span class="ruby-comment cmt"># wait appropriate amounts of time.</span>
 70:         <span class="ruby-comment cmt">#</span>
 71:         <span class="ruby-comment cmt"># We add the discovery timeout to the ddl supplied</span>
 72:         <span class="ruby-comment cmt"># timeout as the discovery timeout tends to be tuned</span>
 73:         <span class="ruby-comment cmt"># for local network conditions and fact source speed</span>
 74:         <span class="ruby-comment cmt"># which would other wise not be accounted for and</span>
 75:         <span class="ruby-comment cmt"># some results might get missed.</span>
 76:         <span class="ruby-comment cmt">#</span>
 77:         <span class="ruby-comment cmt"># We do this only if the timeout is the default 5</span>
 78:         <span class="ruby-comment cmt"># seconds, so that users cli overrides will still</span>
 79:         <span class="ruby-comment cmt"># get applied</span>
 80:         <span class="ruby-keyword kw">begin</span>
 81:           <span class="ruby-ivar">@ddl</span> = <span class="ruby-constant">DDL</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">agent</span>)
 82:           <span class="ruby-ivar">@timeout</span> = <span class="ruby-ivar">@ddl</span>.<span class="ruby-identifier">meta</span>[<span class="ruby-identifier">:timeout</span>] <span class="ruby-operator">+</span> <span class="ruby-ivar">@discovery_timeout</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@timeout</span> <span class="ruby-operator">==</span> <span class="ruby-value">5</span>
 83:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
 84:           <span class="ruby-constant">Log</span>.<span class="ruby-identifier">debug</span>(<span class="ruby-node">&quot;Could not find DDL: #{e}&quot;</span>)
 85:           <span class="ruby-ivar">@ddl</span> = <span class="ruby-keyword kw">nil</span>
 86:         <span class="ruby-keyword kw">end</span>
 87: 
 88:         <span class="ruby-comment cmt"># allows stderr and stdout to be overridden for testing</span>
 89:         <span class="ruby-comment cmt"># but also for web apps that might not want a bunch of stuff</span>
 90:         <span class="ruby-comment cmt"># generated to actual file handles</span>
 91:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">initial_options</span>[<span class="ruby-identifier">:stderr</span>]
 92:           <span class="ruby-ivar">@stderr</span> = <span class="ruby-identifier">initial_options</span>[<span class="ruby-identifier">:stderr</span>]
 93:         <span class="ruby-keyword kw">else</span>
 94:           <span class="ruby-ivar">@stderr</span> = <span class="ruby-constant">STDERR</span>
 95:           <span class="ruby-ivar">@stderr</span>.<span class="ruby-identifier">sync</span> = <span class="ruby-keyword kw">true</span>
 96:         <span class="ruby-keyword kw">end</span>
 97: 
 98:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">initial_options</span>[<span class="ruby-identifier">:stdout</span>]
 99:           <span class="ruby-ivar">@stdout</span> = <span class="ruby-identifier">initial_options</span>[<span class="ruby-identifier">:stdout</span>]
100:         <span class="ruby-keyword kw">else</span>
101:           <span class="ruby-ivar">@stdout</span> = <span class="ruby-constant">STDOUT</span>
102:           <span class="ruby-ivar">@stdout</span>.<span class="ruby-identifier">sync</span> = <span class="ruby-keyword kw">true</span>
103:         <span class="ruby-keyword kw">end</span>
104:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000117" class="method-detail">
        <a name="M000117"></a>

        <div class="method-heading">
          <a href="#M000117" class="method-signature">
          <span class="method-name">agent_filter</span><span class="method-args">(agent)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the agent filter
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000117-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000117-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 347</span>
347:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">agent_filter</span>(<span class="ruby-identifier">agent</span>)
348:         <span class="ruby-ivar">@filter</span>[<span class="ruby-value str">&quot;agent&quot;</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">agent</span>
349:         <span class="ruby-ivar">@filter</span>[<span class="ruby-value str">&quot;agent&quot;</span>].<span class="ruby-identifier">compact!</span>
350:         <span class="ruby-identifier">reset</span>
351:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000127" class="method-detail">
        <a name="M000127"></a>

        <div class="method-heading">
          <a href="#M000127" class="method-signature">
          <span class="method-name">batch_size=</span><span class="method-args">(limit)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the batch size, if the size is set to 0 that will disable batch mode
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000127-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000127-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 519</span>
519:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">batch_size=</span>(<span class="ruby-identifier">limit</span>)
520:         <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;Can only set batch size if direct addressing is supported&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Config</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">direct_addressing</span>
521: 
522:         <span class="ruby-ivar">@batch_size</span> = <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">limit</span>)
523:         <span class="ruby-ivar">@batch_mode</span> = <span class="ruby-ivar">@batch_size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
524:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000128" class="method-detail">
        <a name="M000128"></a>

        <div class="method-heading">
          <a href="#M000128" class="method-signature">
          <span class="method-name">batch_sleep_time=</span><span class="method-args">(time)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000128-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000128-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 526</span>
526:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">batch_sleep_time=</span>(<span class="ruby-identifier">time</span>)
527:         <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;Can only set batch sleep time if direct addressing is supported&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Config</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">direct_addressing</span>
528: 
529:         <span class="ruby-ivar">@batch_sleep_time</span> = <span class="ruby-constant">Float</span>(<span class="ruby-identifier">time</span>)
530:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000115" class="method-detail">
        <a name="M000115"></a>

        <div class="method-heading">
          <a href="#M000115" class="method-signature">
          <span class="method-name">class_filter</span><span class="method-args">(klass)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the class filter
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000115-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000115-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 323</span>
323:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">class_filter</span>(<span class="ruby-identifier">klass</span>)
324:         <span class="ruby-ivar">@filter</span>[<span class="ruby-value str">&quot;cf_class&quot;</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">klass</span>
325:         <span class="ruby-ivar">@filter</span>[<span class="ruby-value str">&quot;cf_class&quot;</span>].<span class="ruby-identifier">compact!</span>
326:         <span class="ruby-identifier">reset</span>
327:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000124" class="method-detail">
        <a name="M000124"></a>

        <div class="method-heading">
          <a href="#M000124" class="method-signature">
          <span class="method-name">collective=</span><span class="method-args">(c)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the collective we are communicating with
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000124-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000124-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 487</span>
487:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">collective=</span>(<span class="ruby-identifier">c</span>)
488:         <span class="ruby-ivar">@collective</span> = <span class="ruby-identifier">c</span>
489:         <span class="ruby-ivar">@client</span>.<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:collective</span>] = <span class="ruby-identifier">c</span>
490:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000119" class="method-detail">
        <a name="M000119"></a>

        <div class="method-heading">
          <a href="#M000119" class="method-signature">
          <span class="method-name">compound_filter</span><span class="method-args">(filter)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Set a compound filter
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000119-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000119-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 361</span>
361:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">compound_filter</span>(<span class="ruby-identifier">filter</span>)
362:         <span class="ruby-ivar">@filter</span>[<span class="ruby-value str">&quot;compound&quot;</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Matcher</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">filter</span>).<span class="ruby-identifier">execution_stack</span>
363:         <span class="ruby-identifier">reset</span>
364:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000114" class="method-detail">
        <a name="M000114"></a>

        <div class="method-heading">
          <a href="#M000114" class="method-signature">
          <span class="method-name">custom_request</span><span class="method-args">(action, args, expected_agents, filter = {}, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Constructs custom requests with custom filters and discovery data the idea
is that this would be used in web applications where you might be using a
cached copy of data provided by a registration agent to figure out on your
own what nodes will be responding and what your filter would be.
</p>
<p>
This will <a href="Client.html#M000111">help</a> you essentially short
circuit the traditional cycle of:
</p>
<p>
mc <a href="Client.html#M000122">discover</a> / call / wait for discovered
nodes
</p>
<p>
by doing discovery however you like, contructing a filter and a list of
nodes you expect responses from.
</p>
<p>
Other than that it will work exactly like a normal call, blocks will behave
the same way, stats will be handled the same way etcetc
</p>
<p>
If you just wanted to contact one machine for example with a client that
already has other filter <a href="Client.html#M000123">options</a> setup
you can do:
</p>
<p>
puppet.custom_request(&quot;runonce&quot;, {}, [&quot;your.box.com&quot;],
{:identity =&gt; &quot;your.box.com&quot;})
</p>
<p>
This will do runonce action on just &#8216;your.box.com&#8217;, no
discovery will be done and after receiving just one response it will stop
waiting for responses
</p>
<p>
If direct_addressing is enabled in the config file you can provide an empty
hash as a filter, this will force that request to be a directly addressed
request which technically does not need filters. If you try to use this
mode with direct addressing disabled an exception will be raise
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000114-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000114-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 274</span>
274:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">custom_request</span>(<span class="ruby-identifier">action</span>, <span class="ruby-identifier">args</span>, <span class="ruby-identifier">expected_agents</span>, <span class="ruby-identifier">filter</span> = {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
275:         <span class="ruby-ivar">@ddl</span>.<span class="ruby-identifier">validate_request</span>(<span class="ruby-identifier">action</span>, <span class="ruby-identifier">args</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@ddl</span>
276: 
277:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">filter</span> <span class="ruby-operator">==</span> {} <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-constant">Config</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">direct_addressing</span>
278:           <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;Attempted to do a filterless custom_request without direct_addressing enabled, preventing unexpected call to all nodes&quot;</span>
279:         <span class="ruby-keyword kw">end</span>
280: 
281:         <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">reset</span>
282: 
283:         <span class="ruby-identifier">custom_filter</span> = <span class="ruby-constant">Util</span>.<span class="ruby-identifier">empty_filter</span>
284:         <span class="ruby-identifier">custom_options</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">clone</span>
285: 
286:         <span class="ruby-comment cmt"># merge the supplied filter with the standard empty one</span>
287:         <span class="ruby-comment cmt"># we could just use the merge method but I want to be sure</span>
288:         <span class="ruby-comment cmt"># we dont merge in stuff that isnt actually valid</span>
289:         [<span class="ruby-value str">&quot;identity&quot;</span>, <span class="ruby-value str">&quot;fact&quot;</span>, <span class="ruby-value str">&quot;agent&quot;</span>, <span class="ruby-value str">&quot;cf_class&quot;</span>, <span class="ruby-value str">&quot;compound&quot;</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ftype</span><span class="ruby-operator">|</span>
290:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">filter</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">ftype</span>)
291:             <span class="ruby-identifier">custom_filter</span>[<span class="ruby-identifier">ftype</span>] = [<span class="ruby-identifier">filter</span>[<span class="ruby-identifier">ftype</span>], <span class="ruby-identifier">custom_filter</span>[<span class="ruby-identifier">ftype</span>]].<span class="ruby-identifier">flatten</span>
292:           <span class="ruby-keyword kw">end</span>
293:         <span class="ruby-keyword kw">end</span>
294: 
295:         <span class="ruby-comment cmt"># ensure that all filters at least restrict the call to the agent we're a proxy for</span>
296:         <span class="ruby-identifier">custom_filter</span>[<span class="ruby-value str">&quot;agent&quot;</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@agent</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">custom_filter</span>[<span class="ruby-value str">&quot;agent&quot;</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-ivar">@agent</span>)
297:         <span class="ruby-identifier">custom_options</span>[<span class="ruby-identifier">:filter</span>] = <span class="ruby-identifier">custom_filter</span>
298: 
299:         <span class="ruby-comment cmt"># Fake out the stats discovery would have put there</span>
300:         <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">discovered_agents</span>([<span class="ruby-identifier">expected_agents</span>].<span class="ruby-identifier">flatten</span>)
301: 
302:         <span class="ruby-comment cmt"># Handle fire and forget requests</span>
303:         <span class="ruby-comment cmt">#</span>
304:         <span class="ruby-comment cmt"># If a specific reply-to was set then from the client perspective this should</span>
305:         <span class="ruby-comment cmt"># be a fire and forget request too since no response will ever reach us - it</span>
306:         <span class="ruby-comment cmt"># will go to the reply-to destination</span>
307:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>[<span class="ruby-identifier">:process_results</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@reply_to</span>
308:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">fire_and_forget_request</span>(<span class="ruby-identifier">action</span>, <span class="ruby-identifier">args</span>, <span class="ruby-identifier">custom_filter</span>)
309:         <span class="ruby-keyword kw">end</span>
310: 
311:         <span class="ruby-comment cmt"># Now do a call pretty much exactly like in method_missing except with our own</span>
312:         <span class="ruby-comment cmt"># options and discovery magic</span>
313:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
314:           <span class="ruby-identifier">call_agent</span>(<span class="ruby-identifier">action</span>, <span class="ruby-identifier">args</span>, <span class="ruby-identifier">custom_options</span>, [<span class="ruby-identifier">expected_agents</span>].<span class="ruby-identifier">flatten</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
315:             <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">r</span>)
316:           <span class="ruby-keyword kw">end</span>
317:         <span class="ruby-keyword kw">else</span>
318:           <span class="ruby-identifier">call_agent</span>(<span class="ruby-identifier">action</span>, <span class="ruby-identifier">args</span>, <span class="ruby-identifier">custom_options</span>, [<span class="ruby-identifier">expected_agents</span>].<span class="ruby-identifier">flatten</span>)
319:         <span class="ruby-keyword kw">end</span>
320:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000110" class="method-detail">
        <a name="M000110"></a>

        <div class="method-heading">
          <a href="#M000110" class="method-signature">
          <span class="method-name">disconnect</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Disconnects cleanly from the middleware
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000110-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000110-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 107</span>
107:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">disconnect</span>
108:         <span class="ruby-ivar">@client</span>.<span class="ruby-identifier">disconnect</span>
109:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000122" class="method-detail">
        <a name="M000122"></a>

        <div class="method-heading">
          <a href="#M000122" class="method-signature">
          <span class="method-name">discover</span><span class="method-args">(flags={})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Does discovery based on the filters set, if a discovery was previously done
return that else do a <a href="Client.html#M000109">new</a> discovery.
</p>
<p>
Alternatively if identity filters are given and none of them are regular
expressions then just use the provided data as discovered data, avoiding
discovery
</p>
<p>
Discovery can be forced if direct_addressing is enabled by passing in an
array of nodes with :nodes or JSON data like those produced by mcollective
<a href="../RPC.html">RPC</a> JSON output using :json
</p>
<p>
Will show a message indicating its doing discovery if running verbose or if
the :verbose flag is passed in.
</p>
<p>
Use <a href="Client.html#M000120">reset</a> to force a <a
href="Client.html#M000109">new</a> discovery
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000122-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000122-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 393</span>
393:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">discover</span>(<span class="ruby-identifier">flags</span>={})
394:         <span class="ruby-identifier">flags</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
395:           <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Unknown option #{key} passed to discover&quot;</span> <span class="ruby-keyword kw">unless</span> [<span class="ruby-identifier">:verbose</span>, <span class="ruby-identifier">:hosts</span>, <span class="ruby-identifier">:nodes</span>, <span class="ruby-identifier">:json</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">key</span>)
396:         <span class="ruby-keyword kw">end</span>
397: 
398:         <span class="ruby-identifier">flags</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:verbose</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">verbose</span> = <span class="ruby-identifier">flags</span>[<span class="ruby-identifier">:verbose</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">verbose</span> = <span class="ruby-ivar">@verbose</span>
399: 
400:         <span class="ruby-identifier">verbose</span> = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@output_format</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:console</span>
401: 
402:         <span class="ruby-comment cmt"># flags[:nodes] and flags[:hosts] are the same thing, we should never have</span>
403:         <span class="ruby-comment cmt"># allowed :hosts as that was inconsistent with the established terminology</span>
404:         <span class="ruby-identifier">flags</span>[<span class="ruby-identifier">:nodes</span>] = <span class="ruby-identifier">flags</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:hosts</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">flags</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:hosts</span>)
405: 
406:         <span class="ruby-identifier">reset</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">flags</span>[<span class="ruby-identifier">:nodes</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">flags</span>[<span class="ruby-identifier">:json</span>]
407: 
408:         <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@discovered_agents</span>
409:           <span class="ruby-comment cmt"># if either hosts or JSON is supplied try to figure out discovery data from there</span>
410:           <span class="ruby-comment cmt"># if direct_addressing is not enabled this is a critical error as the user might</span>
411:           <span class="ruby-comment cmt"># not have supplied filters so raise an exception</span>
412:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">flags</span>[<span class="ruby-identifier">:nodes</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">flags</span>[<span class="ruby-identifier">:json</span>]
413:             <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;Can only supply discovery data if direct_addressing is enabled&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Config</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">direct_addressing</span>
414: 
415:             <span class="ruby-identifier">hosts</span> = []
416: 
417:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">flags</span>[<span class="ruby-identifier">:nodes</span>]
418:               <span class="ruby-identifier">hosts</span> = <span class="ruby-constant">Helpers</span>.<span class="ruby-identifier">extract_hosts_from_array</span>(<span class="ruby-identifier">flags</span>[<span class="ruby-identifier">:nodes</span>])
419:             <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">flags</span>[<span class="ruby-identifier">:json</span>]
420:               <span class="ruby-identifier">hosts</span> = <span class="ruby-constant">Helpers</span>.<span class="ruby-identifier">extract_hosts_from_json</span>(<span class="ruby-identifier">flags</span>[<span class="ruby-identifier">:json</span>])
421:             <span class="ruby-keyword kw">end</span>
422: 
423:             <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;Could not find any hosts in discovery data provided&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">hosts</span>.<span class="ruby-identifier">empty?</span>
424: 
425:             <span class="ruby-ivar">@discovered_agents</span> = <span class="ruby-identifier">hosts</span>
426:             <span class="ruby-ivar">@force_direct_request</span> = <span class="ruby-keyword kw">true</span>
427: 
428:           <span class="ruby-comment cmt"># if an identity filter is supplied and it is all strings no regex we can use that</span>
429:           <span class="ruby-comment cmt"># as discovery data, technically the identity filter is then redundant if we are</span>
430:           <span class="ruby-comment cmt"># in direct addressing mode and we could empty it out but this use case should</span>
431:           <span class="ruby-comment cmt"># only really be for a few -I's on the CLI</span>
432:           <span class="ruby-comment cmt">#</span>
433:           <span class="ruby-comment cmt"># For safety we leave the filter in place for now, that way we can support this</span>
434:           <span class="ruby-comment cmt"># enhancement also in broadcast mode</span>
435:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:filter</span>][<span class="ruby-value str">&quot;identity&quot;</span>].<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
436:             <span class="ruby-identifier">regex_filters</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:filter</span>][<span class="ruby-value str">&quot;identity&quot;</span>].<span class="ruby-identifier">select</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">match</span>(<span class="ruby-value str">&quot;^\/&quot;</span>)}.<span class="ruby-identifier">size</span>
437: 
438:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">regex_filters</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
439:               <span class="ruby-ivar">@discovered_agents</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:filter</span>][<span class="ruby-value str">&quot;identity&quot;</span>].<span class="ruby-identifier">clone</span>
440:               <span class="ruby-ivar">@force_direct_request</span> = <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Config</span>.<span class="ruby-identifier">instance</span>.<span class="ruby-identifier">direct_addressing</span>
441:             <span class="ruby-keyword kw">end</span>
442:           <span class="ruby-keyword kw">end</span>
443:         <span class="ruby-keyword kw">end</span>
444: 
445:         <span class="ruby-comment cmt"># All else fails we do it the hard way using a traditional broadcast</span>
446:         <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@discovered_agents</span>
447:           <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">time_discovery</span> <span class="ruby-identifier">:start</span>
448: 
449:           <span class="ruby-ivar">@stderr</span>.<span class="ruby-identifier">print</span>(<span class="ruby-node">&quot;Determining the amount of hosts matching filter for #{discovery_timeout} seconds .... &quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">verbose</span>
450: 
451:           <span class="ruby-comment cmt"># if the requested limit is a pure number and not a percent</span>
452:           <span class="ruby-comment cmt"># and if we're configured to use the first found hosts as the</span>
453:           <span class="ruby-comment cmt"># limit method then pass in the limit thus minimizing the amount</span>
454:           <span class="ruby-comment cmt"># of work we do in the discover phase and speeding it up significantly</span>
455:           <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@limit_method</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:first</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@limit_targets</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Fixnum</span>)
456:             <span class="ruby-ivar">@discovered_agents</span> = <span class="ruby-ivar">@client</span>.<span class="ruby-identifier">discover</span>(<span class="ruby-ivar">@filter</span>, <span class="ruby-ivar">@discovery_timeout</span>, <span class="ruby-ivar">@limit_targets</span>)
457:           <span class="ruby-keyword kw">else</span>
458:             <span class="ruby-ivar">@discovered_agents</span> = <span class="ruby-ivar">@client</span>.<span class="ruby-identifier">discover</span>(<span class="ruby-ivar">@filter</span>, <span class="ruby-ivar">@discovery_timeout</span>)
459:           <span class="ruby-keyword kw">end</span>
460: 
461:           <span class="ruby-ivar">@force_direct_request</span> = <span class="ruby-keyword kw">false</span>
462:           <span class="ruby-ivar">@stderr</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-ivar">@discovered_agents</span>.<span class="ruby-identifier">size</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">verbose</span>
463: 
464:           <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">time_discovery</span> <span class="ruby-identifier">:end</span>
465:         <span class="ruby-keyword kw">end</span>
466: 
467:         <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">discovered_agents</span>(<span class="ruby-ivar">@discovered_agents</span>)
468:         <span class="ruby-constant">RPC</span>.<span class="ruby-identifier">discovered</span>(<span class="ruby-ivar">@discovered_agents</span>)
469: 
470:         <span class="ruby-ivar">@discovered_agents</span>
471:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000116" class="method-detail">
        <a name="M000116"></a>

        <div class="method-heading">
          <a href="#M000116" class="method-signature">
          <span class="method-name">fact_filter</span><span class="method-args">(fact, value=nil, operator=&quot;=&quot;)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the fact filter
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000116-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000116-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 330</span>
330:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fact_filter</span>(<span class="ruby-identifier">fact</span>, <span class="ruby-identifier">value</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">operator</span>=<span class="ruby-value str">&quot;=&quot;</span>)
331:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">fact</span>.<span class="ruby-identifier">nil?</span>
332:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">fact</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
333: 
334:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span>
335:           <span class="ruby-identifier">parsed</span> = <span class="ruby-constant">Util</span>.<span class="ruby-identifier">parse_fact_string</span>(<span class="ruby-identifier">fact</span>)
336:           <span class="ruby-ivar">@filter</span>[<span class="ruby-value str">&quot;fact&quot;</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">parsed</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">parsed</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
337:         <span class="ruby-keyword kw">else</span>
338:           <span class="ruby-identifier">parsed</span> = <span class="ruby-constant">Util</span>.<span class="ruby-identifier">parse_fact_string</span>(<span class="ruby-node">&quot;#{fact}#{operator}#{value}&quot;</span>)
339:           <span class="ruby-ivar">@filter</span>[<span class="ruby-value str">&quot;fact&quot;</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">parsed</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">parsed</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">false</span>
340:         <span class="ruby-keyword kw">end</span>
341: 
342:         <span class="ruby-ivar">@filter</span>[<span class="ruby-value str">&quot;fact&quot;</span>].<span class="ruby-identifier">compact!</span>
343:         <span class="ruby-identifier">reset</span>
344:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000111" class="method-detail">
        <a name="M000111"></a>

        <div class="method-heading">
          <a href="#M000111" class="method-signature">
          <span class="method-name">help</span><span class="method-args">(template)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns <a href="Client.html#M000111">help</a> for an agent if a <a
href="DDL.html">DDL</a> was found
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000111-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000111-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 112</span>
112:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">help</span>(<span class="ruby-identifier">template</span>)
113:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@ddl</span>
114:           <span class="ruby-ivar">@ddl</span>.<span class="ruby-identifier">help</span>(<span class="ruby-identifier">template</span>)
115:         <span class="ruby-keyword kw">else</span>
116:           <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;Can't find DDL for agent '#{@agent}'&quot;</span>
117:         <span class="ruby-keyword kw">end</span>
118:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000118" class="method-detail">
        <a name="M000118"></a>

        <div class="method-heading">
          <a href="#M000118" class="method-signature">
          <span class="method-name">identity_filter</span><span class="method-args">(identity)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the identity filter
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000118-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000118-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 354</span>
354:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">identity_filter</span>(<span class="ruby-identifier">identity</span>)
355:         <span class="ruby-ivar">@filter</span>[<span class="ruby-value str">&quot;identity&quot;</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">identity</span>
356:         <span class="ruby-ivar">@filter</span>[<span class="ruby-value str">&quot;identity&quot;</span>].<span class="ruby-identifier">compact!</span>
357:         <span class="ruby-identifier">reset</span>
358:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000126" class="method-detail">
        <a name="M000126"></a>

        <div class="method-heading">
          <a href="#M000126" class="method-signature">
          <span class="method-name">limit_method=</span><span class="method-args">(method)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets and sanity check the limit_method variable used to determine how to
limit targets if limit_targets is set
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000126-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000126-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 510</span>
510:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">limit_method=</span>(<span class="ruby-identifier">method</span>)
511:         <span class="ruby-identifier">method</span> = <span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_sym</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">method</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)
512: 
513:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Unknown limit method #{method} must be :random or :first&quot;</span> <span class="ruby-keyword kw">unless</span> [<span class="ruby-identifier">:random</span>, <span class="ruby-identifier">:first</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">method</span>)
514: 
515:         <span class="ruby-ivar">@limit_method</span> = <span class="ruby-identifier">method</span>
516:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000125" class="method-detail">
        <a name="M000125"></a>

        <div class="method-heading">
          <a href="#M000125" class="method-signature">
          <span class="method-name">limit_targets=</span><span class="method-args">(limit)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets and sanity checks the limit_targets variable used to restrict how many
nodes we&#8216;ll target
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000125-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000125-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 494</span>
494:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">limit_targets=</span>(<span class="ruby-identifier">limit</span>)
495:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">limit</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
496:           <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Invalid limit specified: #{limit} valid limits are /^\d+%*$/&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">limit</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\d+%*$/</span>
497: 
498:           <span class="ruby-keyword kw">begin</span>
499:             <span class="ruby-ivar">@limit_targets</span> = <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">limit</span>)
500:           <span class="ruby-keyword kw">rescue</span>
501:             <span class="ruby-ivar">@limit_targets</span> = <span class="ruby-identifier">limit</span>
502:           <span class="ruby-keyword kw">end</span>
503:         <span class="ruby-keyword kw">else</span>
504:           <span class="ruby-ivar">@limit_targets</span> = <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">limit</span>)
505:         <span class="ruby-keyword kw">end</span>
506:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000113" class="method-detail">
        <a name="M000113"></a>

        <div class="method-heading">
          <a href="#M000113" class="method-signature">
          <span class="method-name">method_missing</span><span class="method-args">(method_name, *args, &amp;block)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Magic handler to invoke remote methods
</p>
<p>
Once the stub is created using the constructor or the <a
href="../RPC.html#M000070">RPC#rpcclient</a> helper you can call remote
actions easily:
</p>
<pre>
  ret = rpc.echo(:msg =&gt; &quot;hello world&quot;)
</pre>
<p>
This will call the &#8216;echo&#8217; action of the &#8216;rpctest&#8217;
agent and return the result as an array, the array will be a simplified
result set from the usual full MCollective::Client#req with additional
error codes and error text:
</p>
<p>
{
</p>
<pre>
  :sender =&gt; &quot;remote.box.com&quot;,
  :statuscode =&gt; 0,
  :statusmsg =&gt; &quot;OK&quot;,
  :data =&gt; &quot;hello world&quot;
</pre>
<p>
}
</p>
<p>
If :statuscode is 0 then everything went find, if it&#8216;s 1 then you
supplied the correct arguments etc but the request could not be completed,
you&#8216;ll find a human parsable reason in :statusmsg then.
</p>
<p>
Codes 2 to 5 maps directly to <a
href="../UnknownRPCAction.html">UnknownRPCAction</a>, <a
href="../MissingRPCData.html">MissingRPCData</a>, <a
href="../InvalidRPCData.html">InvalidRPCData</a> and <a
href="../UnknownRPCError.html">UnknownRPCError</a> see below for a
description of those, in each case :statusmsg would be the reason for
failure.
</p>
<p>
To get access to the full result of the MCollective::Client#req calls you
can pass in a block:
</p>
<pre>
  rpc.echo(:msg =&gt; &quot;hello world&quot;) do |resp|
     pp resp
  end
</pre>
<p>
In this case resp will the result from MCollective::Client#req. Instead of
returning simple text and codes as above you&#8216;ll also need to handle
the following exceptions:
</p>
<p>
<a href="../UnknownRPCAction.html">UnknownRPCAction</a> - There is no
matching action on the agent <a
href="../MissingRPCData.html">MissingRPCData</a> - You did not supply all
the needed parameters for the action <a
href="../InvalidRPCData.html">InvalidRPCData</a> - The data you did supply
did not pass validation <a
href="../UnknownRPCError.html">UnknownRPCError</a> - Some other error
prevented the agent from running
</p>
<p>
During calls a progress indicator will be shown of how many results
we&#8216;ve received against how many nodes were discovered, you can
disable this by setting progress to false:
</p>
<pre>
  rpc.progress = false
</pre>
<p>
This supports a 2nd mode where it will send the SimpleRPC request and never
handle the responses. It&#8216;s a bit like UDP, it sends the request with
the filter attached and you only get back the requestid, you have no
indication about results.
</p>
<p>
You can invoke this using:
</p>
<pre>
  puts rpc.echo(:process_results =&gt; false)
</pre>
<p>
This will output just the request id.
</p>
<p>
Batched processing is supported:
</p>
<pre>
  printrpc rpc.ping(:batch_size =&gt; 5)
</pre>
<p>
This will do everything exactly as normal but communicate to only 5 agents
at a time
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000113-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000113-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 209</span>
209:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">method_missing</span>(<span class="ruby-identifier">method_name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
210:         <span class="ruby-comment cmt"># set args to an empty hash if nothings given</span>
211:         <span class="ruby-identifier">args</span> = <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>]
212:         <span class="ruby-identifier">args</span> = {} <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">nil?</span>
213: 
214:         <span class="ruby-identifier">action</span> = <span class="ruby-identifier">method_name</span>.<span class="ruby-identifier">to_s</span>
215: 
216:         <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">reset</span>
217: 
218:         <span class="ruby-ivar">@ddl</span>.<span class="ruby-identifier">validate_request</span>(<span class="ruby-identifier">action</span>, <span class="ruby-identifier">args</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@ddl</span>
219: 
220:         <span class="ruby-comment cmt"># if a global batch size is set just use that else set it</span>
221:         <span class="ruby-comment cmt"># in the case that it was passed as an argument</span>
222:         <span class="ruby-identifier">batch_mode</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:batch_size</span>) <span class="ruby-operator">||</span> <span class="ruby-ivar">@batch_mode</span>
223:         <span class="ruby-identifier">batch_size</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:batch_size</span>) <span class="ruby-operator">||</span> <span class="ruby-ivar">@batch_size</span>
224:         <span class="ruby-identifier">batch_sleep_time</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:batch_sleep_time</span>) <span class="ruby-operator">||</span> <span class="ruby-ivar">@batch_sleep_time</span>
225: 
226:         <span class="ruby-comment cmt"># if we were given a batch_size argument thats 0 and batch_mode was</span>
227:         <span class="ruby-comment cmt"># determined to be on via global options etc this will allow a batch_size</span>
228:         <span class="ruby-comment cmt"># of 0 to disable or batch_mode for this call only</span>
229:         <span class="ruby-identifier">batch_mode</span> = (<span class="ruby-identifier">batch_mode</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">batch_size</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
230: 
231:         <span class="ruby-comment cmt"># Handle single target requests by doing discovery and picking</span>
232:         <span class="ruby-comment cmt"># a random node.  Then do a custom request specifying a filter</span>
233:         <span class="ruby-comment cmt"># that will only match the one node.</span>
234:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@limit_targets</span>
235:           <span class="ruby-identifier">target_nodes</span> = <span class="ruby-identifier">pick_nodes_from_discovered</span>(<span class="ruby-ivar">@limit_targets</span>)
236:           <span class="ruby-constant">Log</span>.<span class="ruby-identifier">debug</span>(<span class="ruby-node">&quot;Picked #{target_nodes.join(',')} as limited target(s)&quot;</span>)
237: 
238:           <span class="ruby-identifier">custom_request</span>(<span class="ruby-identifier">action</span>, <span class="ruby-identifier">args</span>, <span class="ruby-identifier">target_nodes</span>, {<span class="ruby-value str">&quot;identity&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">/^(#{target_nodes.join('|')})$/</span>}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
239:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">batch_mode</span>
240:           <span class="ruby-identifier">call_agent_batched</span>(<span class="ruby-identifier">action</span>, <span class="ruby-identifier">args</span>, <span class="ruby-identifier">options</span>, <span class="ruby-identifier">batch_size</span>, <span class="ruby-identifier">batch_sleep_time</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
241:         <span class="ruby-keyword kw">else</span>
242:           <span class="ruby-identifier">call_agent</span>(<span class="ruby-identifier">action</span>, <span class="ruby-identifier">args</span>, <span class="ruby-identifier">options</span>, <span class="ruby-identifier">:auto</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
243:         <span class="ruby-keyword kw">end</span>
244:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000112" class="method-detail">
        <a name="M000112"></a>

        <div class="method-heading">
          <a href="#M000112" class="method-signature">
          <span class="method-name">new_request</span><span class="method-args">(action, data)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates a suitable request hash for the SimpleRPC agent.
</p>
<p>
You&#8216;d use this if you ever wanted to take care of sending requests on
your own - perhaps via Client#sendreq if you didn&#8216;t care for
responses.
</p>
<p>
In that case you can just do:
</p>
<pre>
  msg = your_rpc.new_request(&quot;some_action&quot;, :foo =&gt; :bar)
  filter = your_rpc.filter

  your_rpc.client.sendreq(msg, msg[:agent], filter)
</pre>
<p>
This will send a SimpleRPC request to the action some_action with arguments
:foo = :bar, it will return immediately and you will have no indication at
all if the request was receieved or not
</p>
<p>
Clearly the use of this technique should be limited and done only if your
code requires such a thing
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000112-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000112-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 139</span>
139:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">new_request</span>(<span class="ruby-identifier">action</span>, <span class="ruby-identifier">data</span>)
140:         <span class="ruby-identifier">callerid</span> = <span class="ruby-constant">PluginManager</span>[<span class="ruby-value str">&quot;security_plugin&quot;</span>].<span class="ruby-identifier">callerid</span>
141: 
142:         <span class="ruby-identifier">raise</span> <span class="ruby-value str">'callerid received from security plugin is not valid'</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">PluginManager</span>[<span class="ruby-value str">&quot;security_plugin&quot;</span>].<span class="ruby-identifier">valid_callerid?</span>(<span class="ruby-identifier">callerid</span>)
143: 
144:         {<span class="ruby-identifier">:agent</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@agent</span>,
145:          <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">action</span>,
146:          <span class="ruby-identifier">:caller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">callerid</span>,
147:          <span class="ruby-identifier">:data</span>   =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">data</span>}
148:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000123" class="method-detail">
        <a name="M000123"></a>

        <div class="method-heading">
          <a href="#M000123" class="method-signature">
          <span class="method-name">options</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Provides a normal <a href="Client.html#M000123">options</a> hash like you
would get from <a href="../Optionparser.html">Optionparser</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000123-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000123-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 475</span>
475:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">options</span>
476:         {<span class="ruby-identifier">:disctimeout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@discovery_timeout</span>,
477:          <span class="ruby-identifier">:timeout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@timeout</span>,
478:          <span class="ruby-identifier">:verbose</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@verbose</span>,
479:          <span class="ruby-identifier">:filter</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@filter</span>,
480:          <span class="ruby-identifier">:collective</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@collective</span>,
481:          <span class="ruby-identifier">:output_format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@output_format</span>,
482:          <span class="ruby-identifier">:ttl</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@ttl</span>,
483:          <span class="ruby-identifier">:config</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@config</span>}
484:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000120" class="method-detail">
        <a name="M000120"></a>

        <div class="method-heading">
          <a href="#M000120" class="method-signature">
          <span class="method-name">reset</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Resets various internal parts of the class, most importantly it clears out
the cached discovery
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000120-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000120-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 368</span>
368:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reset</span>
369:         <span class="ruby-ivar">@discovered_agents</span> = <span class="ruby-keyword kw">nil</span>
370:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000121" class="method-detail">
        <a name="M000121"></a>

        <div class="method-heading">
          <a href="#M000121" class="method-signature">
          <span class="method-name">reset_filter</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Reet the filter to an empty one
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000121-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000121-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/rpc/client.rb, line 373</span>
373:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">reset_filter</span>
374:         <span class="ruby-ivar">@filter</span> = <span class="ruby-constant">Util</span>.<span class="ruby-identifier">empty_filter</span>
375:         <span class="ruby-identifier">agent_filter</span> <span class="ruby-ivar">@agent</span>
376:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>