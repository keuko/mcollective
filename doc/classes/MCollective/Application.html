<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: MCollective::Application</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">MCollective::Application</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../files/lib/mcollective/application_rb.html">
                lib/mcollective/application.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000285">[]</a>&nbsp;&nbsp;
      <a href="#M000284">[]=</a>&nbsp;&nbsp;
      <a href="#M000300">application_cli_arguments</a>&nbsp;&nbsp;
      <a href="#M000298">application_description</a>&nbsp;&nbsp;
      <a href="#M000301">application_failure</a>&nbsp;&nbsp;
      <a href="#M000283">application_options</a>&nbsp;&nbsp;
      <a href="#M000297">application_options</a>&nbsp;&nbsp;
      <a href="#M000295">application_parse_options</a>&nbsp;&nbsp;
      <a href="#M000299">application_usage</a>&nbsp;&nbsp;
      <a href="#M000294">clioptions</a>&nbsp;&nbsp;
      <a href="#M000291">configuration</a>&nbsp;&nbsp;
      <a href="#M000286">description</a>&nbsp;&nbsp;
      <a href="#M000304">disconnect</a>&nbsp;&nbsp;
      <a href="#M000288">exclude_argument_sections</a>&nbsp;&nbsp;
      <a href="#M000306">halt</a>&nbsp;&nbsp;
      <a href="#M000302">help</a>&nbsp;&nbsp;
      <a href="#M000290">intialize_application_options</a>&nbsp;&nbsp;
      <a href="#M000305">main</a>&nbsp;&nbsp;
      <a href="#M000289">option</a>&nbsp;&nbsp;
      <a href="#M000292">options</a>&nbsp;&nbsp;
      <a href="#M000307">rpcclient</a>&nbsp;&nbsp;
      <a href="#M000303">run</a>&nbsp;&nbsp;
      <a href="#M000287">usage</a>&nbsp;&nbsp;
      <a href="#M000296">validate_cli_options</a>&nbsp;&nbsp;
      <a href="#M000293">validate_option</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name"><a href="RPC.html">RPC</a></span>
      </div>
    </div>

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000285" class="method-detail">
        <a name="M000285"></a>

        <div class="method-heading">
          <a href="#M000285" class="method-signature">
          <span class="method-name">[]</span><span class="method-args">(option)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
retrieves a specific <a href="Application.html#M000289">option</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000285-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000285-source">
<pre>
    <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 20</span>
20:       <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">option</span>)
21:         <span class="ruby-identifier">intialize_application_options</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@application_options</span>
22:         <span class="ruby-ivar">@application_options</span>[<span class="ruby-identifier">option</span>]
23:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000284" class="method-detail">
        <a name="M000284"></a>

        <div class="method-heading">
          <a href="#M000284" class="method-signature">
          <span class="method-name">[]=</span><span class="method-args">(option, value)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
set an <a href="Application.html#M000289">option</a> in the <a
href="Application.html#M000292">options</a> hash
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000284-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000284-source">
<pre>
    <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 14</span>
14:       <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]=</span>(<span class="ruby-identifier">option</span>, <span class="ruby-identifier">value</span>)
15:         <span class="ruby-identifier">intialize_application_options</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@application_options</span>
16:         <span class="ruby-ivar">@application_options</span>[<span class="ruby-identifier">option</span>] = <span class="ruby-identifier">value</span>
17:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000283" class="method-detail">
        <a name="M000283"></a>

        <div class="method-heading">
          <a href="#M000283" class="method-signature">
          <span class="method-name">application_options</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Intialize a blank set of <a href="Application.html#M000292">options</a> if
its the first time used else returns active <a
href="Application.html#M000292">options</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000283-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000283-source">
<pre>
    <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 8</span>
 8:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">application_options</span>
 9:         <span class="ruby-identifier">intialize_application_options</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@application_options</span>
10:         <span class="ruby-ivar">@application_options</span>
11:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000286" class="method-detail">
        <a name="M000286"></a>

        <div class="method-heading">
          <a href="#M000286" class="method-signature">
          <span class="method-name">description</span><span class="method-args">(descr)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the application <a href="Application.html#M000286">description</a>,
there can be only one <a href="Application.html#M000286">description</a>
per application so multiple calls will just change the <a
href="Application.html#M000286">description</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000286-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000286-source">
<pre>
    <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 28</span>
28:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">description</span>(<span class="ruby-identifier">descr</span>)
29:         <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">:description</span>] = <span class="ruby-identifier">descr</span>
30:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000288" class="method-detail">
        <a name="M000288"></a>

        <div class="method-heading">
          <a href="#M000288" class="method-signature">
          <span class="method-name">exclude_argument_sections</span><span class="method-args">(*sections)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000288-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000288-source">
<pre>
    <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 38</span>
38:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">exclude_argument_sections</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">sections</span>)
39:         <span class="ruby-identifier">sections</span> = [<span class="ruby-identifier">sections</span>].<span class="ruby-identifier">flatten</span>
40: 
41:         <span class="ruby-identifier">sections</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>
42:           <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Unknown CLI argument section #{s}&quot;</span> <span class="ruby-keyword kw">unless</span> [<span class="ruby-value str">&quot;rpc&quot;</span>, <span class="ruby-value str">&quot;common&quot;</span>, <span class="ruby-value str">&quot;filter&quot;</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">s</span>)
43:         <span class="ruby-keyword kw">end</span>
44: 
45:         <span class="ruby-identifier">intialize_application_options</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@application_options</span>
46:         <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">:exclude_arg_sections</span>] = <span class="ruby-identifier">sections</span>
47:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000290" class="method-detail">
        <a name="M000290"></a>

        <div class="method-heading">
          <a href="#M000290" class="method-signature">
          <span class="method-name">intialize_application_options</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates an empty set of <a href="Application.html#M000292">options</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000290-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000290-source">
<pre>
    <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 79</span>
79:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">intialize_application_options</span>
80:         <span class="ruby-ivar">@application_options</span> = {<span class="ruby-identifier">:description</span>          =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>,
81:                                 <span class="ruby-identifier">:usage</span>                =<span class="ruby-operator">&gt;</span> [],
82:                                 <span class="ruby-identifier">:cli_arguments</span>        =<span class="ruby-operator">&gt;</span> [],
83:                                 <span class="ruby-identifier">:exclude_arg_sections</span> =<span class="ruby-operator">&gt;</span> []}
84:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000289" class="method-detail">
        <a name="M000289"></a>

        <div class="method-heading">
          <a href="#M000289" class="method-signature">
          <span class="method-name">option</span><span class="method-args">(name, arguments)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Wrapper to create command line <a
href="Application.html#M000292">options</a>
</p>
<pre>
 - name: varaible name that will be used to access the option value
 - description: textual info shown in --help
 - arguments: a list of possible arguments that can be used
   to activate this option
 - type: a data type that ObjectParser understand of :bool or :array
 - required: true or false if this option has to be supplied
 - validate: a proc that will be called with the value used to validate
   the supplied value

  option :foo,
         :description =&gt; &quot;The foo option&quot;
         :arguments   =&gt; [&quot;--foo ARG&quot;]
</pre>
<p>
after this the value supplied will be in <a
href="Application.html#M000291">configuration</a>[:foo]
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000289-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000289-source">
<pre>
    <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 65</span>
65:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">option</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">arguments</span>)
66:         <span class="ruby-identifier">opt</span> = {<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">name</span>,
67:                <span class="ruby-identifier">:description</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>,
68:                <span class="ruby-identifier">:arguments</span> =<span class="ruby-operator">&gt;</span> [],
69:                <span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">String</span>,
70:                <span class="ruby-identifier">:required</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>,
71:                <span class="ruby-identifier">:validate</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span> { <span class="ruby-keyword kw">true</span> }}
72: 
73:         <span class="ruby-identifier">arguments</span>.<span class="ruby-identifier">each_pair</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">v</span>}
74: 
75:         <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">:cli_arguments</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opt</span>
76:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000287" class="method-detail">
        <a name="M000287"></a>

        <div class="method-heading">
          <a href="#M000287" class="method-signature">
          <span class="method-name">usage</span><span class="method-args">(usage)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Supplies <a href="Application.html#M000287">usage</a> information, calling
multiple times will create multiple <a
href="Application.html#M000287">usage</a> lines in &#8212;<a
href="Application.html#M000302">help</a> output
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000287-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000287-source">
<pre>
    <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 34</span>
34:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">usage</span>(<span class="ruby-identifier">usage</span>)
35:         <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">:usage</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">usage</span>
36:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000300" class="method-detail">
        <a name="M000300"></a>

        <div class="method-heading">
          <a href="#M000300" class="method-signature">
          <span class="method-name">application_cli_arguments</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns an array of all the arguments built using calls to optin
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000300-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000300-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 245</span>
245:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">application_cli_arguments</span>
246:       <span class="ruby-identifier">application_options</span>[<span class="ruby-identifier">:cli_arguments</span>]
247:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000298" class="method-detail">
        <a name="M000298"></a>

        <div class="method-heading">
          <a href="#M000298" class="method-signature">
          <span class="method-name">application_description</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Retrieve the current application <a
href="Application.html#M000286">description</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000298-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000298-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 232</span>
232:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">application_description</span>
233:       <span class="ruby-identifier">application_options</span>[<span class="ruby-identifier">:description</span>]
234:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000301" class="method-detail">
        <a name="M000301"></a>

        <div class="method-heading">
          <a href="#M000301" class="method-signature">
          <span class="method-name">application_failure</span><span class="method-args">(e, err_dest=STDERR)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Handles failure, if we&#8216;re far enough in the initialization phase it
will log backtraces if its in verbose mode only
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000301-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000301-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 251</span>
251:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">application_failure</span>(<span class="ruby-identifier">e</span>, <span class="ruby-identifier">err_dest</span>=<span class="ruby-constant">STDERR</span>)
252:       <span class="ruby-comment cmt"># peole can use exit() anywhere and not get nasty backtraces as a result</span>
253:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">SystemExit</span>)
254:         <span class="ruby-identifier">disconnect</span>
255:         <span class="ruby-identifier">raise</span>(<span class="ruby-identifier">e</span>)
256:       <span class="ruby-keyword kw">end</span>
257: 
258:       <span class="ruby-identifier">err_dest</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{$0} failed to run: #{e} (#{e.class})&quot;</span>
259: 
260:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:verbose</span>]
261:         <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">l</span><span class="ruby-operator">|</span> <span class="ruby-identifier">err_dest</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;\tfrom #{l}&quot;</span>}
262:       <span class="ruby-keyword kw">end</span>
263: 
264:       <span class="ruby-identifier">disconnect</span>
265: 
266:       <span class="ruby-identifier">exit</span> <span class="ruby-value">1</span>
267:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000297" class="method-detail">
        <a name="M000297"></a>

        <div class="method-heading">
          <a href="#M000297" class="method-signature">
          <span class="method-name">application_options</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Retrieves the full hash of application <a
href="Application.html#M000292">options</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000297-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000297-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 227</span>
227:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">application_options</span>
228:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">application_options</span>
229:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000295" class="method-detail">
        <a name="M000295"></a>

        <div class="method-heading">
          <a href="#M000295" class="method-signature">
          <span class="method-name">application_parse_options</span><span class="method-args">(help=false)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Builds an ObjectParser config, parse the CLI <a
href="Application.html#M000292">options</a> and validates based on the <a
href="Application.html#M000289">option</a> config
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000295-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000295-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 135</span>
135:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">application_parse_options</span>(<span class="ruby-identifier">help</span>=<span class="ruby-keyword kw">false</span>)
136:       <span class="ruby-ivar">@options</span> <span class="ruby-operator">||=</span> {<span class="ruby-identifier">:verbose</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>}
137: 
138:       <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">clioptions</span>(<span class="ruby-identifier">help</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">parser</span>, <span class="ruby-identifier">options</span><span class="ruby-operator">|</span>
139:         <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">define_head</span> <span class="ruby-identifier">application_description</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">application_description</span>
140:         <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">banner</span> = <span class="ruby-value str">&quot;&quot;</span>
141: 
142:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">application_usage</span>
143:           <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">separator</span> <span class="ruby-value str">&quot;&quot;</span>
144: 
145:           <span class="ruby-identifier">application_usage</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">u</span><span class="ruby-operator">|</span>
146:             <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">separator</span> <span class="ruby-node">&quot;Usage: #{u}&quot;</span>
147:           <span class="ruby-keyword kw">end</span>
148: 
149:           <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">separator</span> <span class="ruby-value str">&quot;&quot;</span>
150:         <span class="ruby-keyword kw">end</span>
151: 
152:         <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">define_tail</span> <span class="ruby-value str">&quot;&quot;</span>
153:         <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">define_tail</span> <span class="ruby-node">&quot;The Marionette Collective #{MCollective.version}&quot;</span>
154: 
155: 
156:         <span class="ruby-identifier">application_cli_arguments</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">carg</span><span class="ruby-operator">|</span>
157:           <span class="ruby-identifier">opts_array</span> = []
158: 
159:           <span class="ruby-identifier">opts_array</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">:on</span>
160: 
161:           <span class="ruby-comment cmt"># if a default is set from the application set it up front</span>
162:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">carg</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:default</span>)
163:             <span class="ruby-identifier">configuration</span>[<span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:name</span>]] = <span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:default</span>]
164:           <span class="ruby-keyword kw">end</span>
165: 
166:           <span class="ruby-comment cmt"># :arguments are multiple possible ones</span>
167:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:arguments</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
168:             <span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:arguments</span>].<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span> <span class="ruby-identifier">opts_array</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">a</span>}
169:           <span class="ruby-keyword kw">else</span>
170:             <span class="ruby-identifier">opts_array</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:arguments</span>]
171:           <span class="ruby-keyword kw">end</span>
172: 
173:           <span class="ruby-comment cmt"># type was given and its not one of our special types, just pass it onto optparse</span>
174:           <span class="ruby-identifier">opts_array</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:type</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:type</span>] <span class="ruby-keyword kw">and</span> <span class="ruby-operator">!</span> [<span class="ruby-identifier">:bool</span>, <span class="ruby-identifier">:array</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:type</span>])
175: 
176:           <span class="ruby-identifier">opts_array</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:description</span>]
177: 
178:           <span class="ruby-comment cmt"># Handle our special types else just rely on the optparser to handle the types</span>
179:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:type</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">:bool</span>
180:             <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">send</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">opts_array</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
181:               <span class="ruby-identifier">validate_option</span>(<span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:validate</span>], <span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:name</span>], <span class="ruby-identifier">v</span>)
182: 
183:               <span class="ruby-identifier">configuration</span>[<span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:name</span>]] = <span class="ruby-keyword kw">true</span>
184:             <span class="ruby-keyword kw">end</span>
185: 
186:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:type</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">:array</span>
187:             <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">send</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">opts_array</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
188:               <span class="ruby-identifier">validate_option</span>(<span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:validate</span>], <span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:name</span>], <span class="ruby-identifier">v</span>)
189: 
190:               <span class="ruby-identifier">configuration</span>[<span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:name</span>]] = [] <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:name</span>])
191:               <span class="ruby-identifier">configuration</span>[<span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:name</span>]] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">v</span>
192:             <span class="ruby-keyword kw">end</span>
193: 
194:           <span class="ruby-keyword kw">else</span>
195:             <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">send</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">opts_array</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
196:               <span class="ruby-identifier">validate_option</span>(<span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:validate</span>], <span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:name</span>], <span class="ruby-identifier">v</span>)
197: 
198:               <span class="ruby-identifier">configuration</span>[<span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:name</span>]] = <span class="ruby-identifier">v</span>
199:             <span class="ruby-keyword kw">end</span>
200:           <span class="ruby-keyword kw">end</span>
201:         <span class="ruby-keyword kw">end</span>
202:       <span class="ruby-keyword kw">end</span>
203:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000299" class="method-detail">
        <a name="M000299"></a>

        <div class="method-heading">
          <a href="#M000299" class="method-signature">
          <span class="method-name">application_usage</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Return the current <a href="Application.html#M000287">usage</a> text false
if nothing is set
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000299-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000299-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 237</span>
237:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">application_usage</span>
238:       <span class="ruby-identifier">usage</span> = <span class="ruby-identifier">application_options</span>[<span class="ruby-identifier">:usage</span>]
239: 
240:       <span class="ruby-identifier">usage</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">false</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">usage</span>
241:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000294" class="method-detail">
        <a name="M000294"></a>

        <div class="method-heading">
          <a href="#M000294" class="method-signature">
          <span class="method-name">clioptions</span><span class="method-args">(help) {|parser, options| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Creates a standard <a href="Application.html#M000292">options</a> hash,
pass in a block to add extra headings etc see <a
href="Optionparser.html">Optionparser</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000294-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000294-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 111</span>
111:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">clioptions</span>(<span class="ruby-identifier">help</span>)
112:       <span class="ruby-identifier">oparser</span> = <span class="ruby-constant">Optionparser</span>.<span class="ruby-identifier">new</span>({<span class="ruby-identifier">:verbose</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">:progress_bar</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>}, <span class="ruby-value str">&quot;filter&quot;</span>, <span class="ruby-identifier">application_options</span>[<span class="ruby-identifier">:exclude_arg_sections</span>])
113: 
114:       <span class="ruby-identifier">options</span> = <span class="ruby-identifier">oparser</span>.<span class="ruby-identifier">parse</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">parser</span>, <span class="ruby-identifier">options</span><span class="ruby-operator">|</span>
115:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
116:           <span class="ruby-keyword kw">yield</span>(<span class="ruby-identifier">parser</span>, <span class="ruby-identifier">options</span>)
117:         <span class="ruby-keyword kw">end</span>
118: 
119:         <span class="ruby-constant">RPC</span><span class="ruby-operator">::</span><span class="ruby-constant">Helpers</span>.<span class="ruby-identifier">add_simplerpc_options</span>(<span class="ruby-identifier">parser</span>, <span class="ruby-identifier">options</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">application_options</span>[<span class="ruby-identifier">:exclude_arg_sections</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;rpc&quot;</span>)
120:       <span class="ruby-keyword kw">end</span>
121: 
122:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">oparser</span>.<span class="ruby-identifier">parser</span>.<span class="ruby-identifier">help</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">help</span>
123: 
124:       <span class="ruby-identifier">validate_cli_options</span>
125: 
126:       <span class="ruby-identifier">post_option_parser</span>(<span class="ruby-identifier">configuration</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:post_option_parser</span>)
127: 
128:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">options</span>
129:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
130:       <span class="ruby-identifier">application_failure</span>(<span class="ruby-identifier">e</span>)
131:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000291" class="method-detail">
        <a name="M000291"></a>

        <div class="method-heading">
          <a href="#M000291" class="method-signature">
          <span class="method-name">configuration</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
The application <a href="Application.html#M000291">configuration</a> built
from CLI arguments
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000291-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000291-source">
<pre>
    <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 88</span>
88:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">configuration</span>
89:       <span class="ruby-ivar">@application_configuration</span> <span class="ruby-operator">||=</span> {}
90:       <span class="ruby-ivar">@application_configuration</span>
91:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000304" class="method-detail">
        <a name="M000304"></a>

        <div class="method-heading">
          <a href="#M000304" class="method-signature">
          <span class="method-name">disconnect</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000304-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000304-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 291</span>
291:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">disconnect</span>
292:       <span class="ruby-constant">MCollective</span><span class="ruby-operator">::</span><span class="ruby-constant">PluginManager</span>[<span class="ruby-value str">&quot;connector_plugin&quot;</span>].<span class="ruby-identifier">disconnect</span>
293:     <span class="ruby-keyword kw">rescue</span>
294:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000306" class="method-detail">
        <a name="M000306"></a>

        <div class="method-heading">
          <a href="#M000306" class="method-signature">
          <span class="method-name">halt</span><span class="method-args">(stats)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
A helper that creates a consistent exit code for applications by looking at
an instance of <a href="RPC/Stats.html">MCollective::RPC::Stats</a>
</p>
<p>
Exit with 0 if nodes were discovered and all passed Exit with 0 if no
discovery were done and &gt; 0 responses were received Exit with 1 if no
nodes were discovered Exit with 2 if nodes were discovered but some <a
href="RPC.html">RPC</a> requests failed Exit with 3 if nodes were
discovered, but not responses receivedif Exit with 4 if no discovery were
done and no responses were received
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000306-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000306-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 312</span>
312:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">halt</span>(<span class="ruby-identifier">stats</span>)
313:       <span class="ruby-identifier">request_stats</span> = {<span class="ruby-identifier">:discoverytime</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>,
314:                        <span class="ruby-identifier">:discovered</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>,
315:                        <span class="ruby-identifier">:failcount</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">stats</span>.<span class="ruby-identifier">to_hash</span>)
316: 
317:       <span class="ruby-comment cmt"># was discovery done?</span>
318:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request_stats</span>[<span class="ruby-identifier">:discoverytime</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
319:         <span class="ruby-comment cmt"># was any nodes discovered</span>
320:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request_stats</span>[<span class="ruby-identifier">:discovered</span>] <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
321:           <span class="ruby-identifier">exit</span> <span class="ruby-value">1</span>
322: 
323:         <span class="ruby-comment cmt"># nodes were discovered, did we get responses</span>
324:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">request_stats</span>[<span class="ruby-identifier">:responses</span>] <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
325:           <span class="ruby-identifier">exit</span> <span class="ruby-value">3</span>
326: 
327:         <span class="ruby-keyword kw">else</span>
328:           <span class="ruby-comment cmt"># we got responses and discovery was done, no failures</span>
329:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request_stats</span>[<span class="ruby-identifier">:failcount</span>] <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
330:             <span class="ruby-identifier">exit</span> <span class="ruby-value">0</span>
331:           <span class="ruby-keyword kw">else</span>
332:             <span class="ruby-identifier">exit</span> <span class="ruby-value">2</span>
333:           <span class="ruby-keyword kw">end</span>
334:         <span class="ruby-keyword kw">end</span>
335:       <span class="ruby-keyword kw">else</span>
336:         <span class="ruby-comment cmt"># discovery wasnt done and we got no responses</span>
337:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request_stats</span>[<span class="ruby-identifier">:responses</span>] <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
338:           <span class="ruby-identifier">exit</span> <span class="ruby-value">4</span>
339:         <span class="ruby-keyword kw">else</span>
340:           <span class="ruby-identifier">exit</span> <span class="ruby-value">0</span>
341:         <span class="ruby-keyword kw">end</span>
342:       <span class="ruby-keyword kw">end</span>
343:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000302" class="method-detail">
        <a name="M000302"></a>

        <div class="method-heading">
          <a href="#M000302" class="method-signature">
          <span class="method-name">help</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000302-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000302-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 269</span>
269:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">help</span>
270:       <span class="ruby-identifier">application_parse_options</span>(<span class="ruby-keyword kw">true</span>)
271:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000305" class="method-detail">
        <a name="M000305"></a>

        <div class="method-heading">
          <a href="#M000305" class="method-signature">
          <span class="method-name">main</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Fake abstract class that logs if the user tries to use an application
without supplying a <a href="Application.html#M000305">main</a> override
method.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000305-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000305-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 298</span>
298:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">main</span>
299:       <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;Applications need to supply a 'main' method&quot;</span>
300:       <span class="ruby-identifier">exit</span> <span class="ruby-value">1</span>
301:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000292" class="method-detail">
        <a name="M000292"></a>

        <div class="method-heading">
          <a href="#M000292" class="method-signature">
          <span class="method-name">options</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
The active <a href="Application.html#M000292">options</a> hash used for
MC::Client and other <a href="Application.html#M000291">configuration</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000292-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000292-source">
<pre>
    <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 94</span>
94:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">options</span>
95:       <span class="ruby-ivar">@options</span>
96:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000307" class="method-detail">
        <a name="M000307"></a>

        <div class="method-heading">
          <a href="#M000307" class="method-signature">
          <span class="method-name">rpcclient</span><span class="method-args">(agent, flags = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Wrapper around <a href="RPC.html#M000070">MC::RPC#rpcclient</a> that
forcably supplies our <a href="Application.html#M000292">options</a> hash
if someone forgets to pass in <a
href="Application.html#M000292">options</a> in an application the filters
and other cli <a href="Application.html#M000292">options</a> wouldnt take
effect which could have a disasterous outcome
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000307-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000307-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 348</span>
348:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">rpcclient</span>(<span class="ruby-identifier">agent</span>, <span class="ruby-identifier">flags</span> = {})
349:       <span class="ruby-identifier">flags</span>[<span class="ruby-identifier">:options</span>] = <span class="ruby-identifier">options</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">flags</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">:options</span>)
350: 
351:       <span class="ruby-keyword kw">super</span>
352:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000303" class="method-detail">
        <a name="M000303"></a>

        <div class="method-heading">
          <a href="#M000303" class="method-signature">
          <span class="method-name">run</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
The <a href="Application.html#M000305">main</a> logic loop, builds up the
<a href="Application.html#M000292">options</a>, validate <a
href="Application.html#M000291">configuration</a> and calls the <a
href="Application.html#M000305">main</a> as supplied by the user.
Disconnects when done and pass any exception onto the <a
href="Application.html#M000301">application_failure</a> helper
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000303-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000303-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 276</span>
276:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">run</span>
277:       <span class="ruby-identifier">application_parse_options</span>
278: 
279:       <span class="ruby-identifier">validate_configuration</span>(<span class="ruby-identifier">configuration</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:validate_configuration</span>)
280: 
281:       <span class="ruby-constant">Util</span>.<span class="ruby-identifier">setup_windows_sleeper</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Util</span>.<span class="ruby-identifier">windows?</span>
282: 
283:       <span class="ruby-identifier">main</span>
284: 
285:       <span class="ruby-identifier">disconnect</span>
286: 
287:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
288:       <span class="ruby-identifier">application_failure</span>(<span class="ruby-identifier">e</span>)
289:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000296" class="method-detail">
        <a name="M000296"></a>

        <div class="method-heading">
          <a href="#M000296" class="method-signature">
          <span class="method-name">validate_cli_options</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000296-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000296-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 205</span>
205:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validate_cli_options</span>
206:       <span class="ruby-comment cmt"># Check all required parameters were set</span>
207:       <span class="ruby-identifier">validation_passed</span> = <span class="ruby-keyword kw">true</span>
208:       <span class="ruby-identifier">application_cli_arguments</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">carg</span><span class="ruby-operator">|</span>
209:         <span class="ruby-comment cmt"># Check for required arguments</span>
210:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:required</span>]
211:           <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">configuration</span>[ <span class="ruby-identifier">carg</span>[<span class="ruby-identifier">:name</span>] ]
212:             <span class="ruby-identifier">validation_passed</span> = <span class="ruby-keyword kw">false</span>
213:             <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;The #{carg[:name]} option is mandatory&quot;</span>
214:           <span class="ruby-keyword kw">end</span>
215:         <span class="ruby-keyword kw">end</span>
216:       <span class="ruby-keyword kw">end</span>
217: 
218:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">validation_passed</span>
219:         <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;\nPlease run with --help for detailed help&quot;</span>
220:         <span class="ruby-identifier">exit</span> <span class="ruby-value">1</span>
221:       <span class="ruby-keyword kw">end</span>
222: 
223: 
224:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000293" class="method-detail">
        <a name="M000293"></a>

        <div class="method-heading">
          <a href="#M000293" class="method-signature">
          <span class="method-name">validate_option</span><span class="method-args">(blk, name, value)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Calls the supplied block in an <a
href="Application.html#M000289">option</a> for validation, an error raised
will log to STDERR and exit the application
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000293-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000293-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mcollective/application.rb, line 100</span>
100:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validate_option</span>(<span class="ruby-identifier">blk</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">value</span>)
101:       <span class="ruby-identifier">validation_result</span> = <span class="ruby-identifier">blk</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">value</span>)
102: 
103:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">validation_result</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">true</span>
104:         <span class="ruby-constant">STDERR</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Validation of #{name} failed: #{validation_result}&quot;</span>
105:         <span class="ruby-identifier">exit</span> <span class="ruby-value">1</span>
106:       <span class="ruby-keyword kw">end</span>
107:     <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>